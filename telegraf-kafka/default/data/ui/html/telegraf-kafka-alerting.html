<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Kafka Smart Monitoring - Management of embedded alerting framework</title>
    <link rel="shortcut icon" href="/en-US/static/@92F74F933102622F25D139967C9C020242623D8C2AE766D55E7680F38A7DA428.10/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/build/css/bootstrap-enterprise.css" />
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/build/css/splunkjs-dashboard.css" />
    <link rel="stylesheet" type="text/css" media="all" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/telegraf-kafka/boottsrap-btn.css" />
    <link rel="stylesheet" type="text/css" media="all" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/telegraf-kafka/common.css" />
    <link rel="stylesheet" type="text/css" media="all" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/telegraf-kafka/table.css" />
    <link rel="stylesheet" type="text/css" media="all" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/telegraf-kafka/hide_footer.css" />
    <meta name="referrer" content="never" />
    <meta name="referrer" content="no-referrer" />
    <script>
                window._splunk_metrics_events = {
                   push : function() {},
                   active: false,
                   }
    </script>
    <style>
                /* Prevents green disabled button */
                .btn-primary[disabled] {
                    background-color: #337ab7;
                    opacity: .40;
                }
                /* Manage modal hidden properly */
                .modal {
                    display: none;
                }
    </style>
</head>
<body class="simplexml preload locale-en" data-splunk-version="7.2.1" data-splunk-product="splunk">
<!--
BEGIN LAYOUT
This section contains the layout for the dashboard. Splunk uses proprietary
styles in <div> tags, similar to Bootstrap's grid system.
-->
<header>
    <a aria-label="Screen reader users, click here to skip the navigation bar" class="navSkip" href="#navSkip" tabIndex="1">Skip Navigation &gt;</a>
    <div class="header splunk-header">
        <div id="placeholder-splunk-bar">
            <a href="{{SPLUNKWEB_URL_PREFIX}}/app/launcher/home" class="brand" title="splunk &gt; listen to your data">splunk<strong>&gt;</strong></a>
        </div>
        <div id="placeholder-app-bar"></div>
    </div>
    <a id="navSkip"></a>
</header>
<div class="dashboard-body container-fluid main-section-body" data-role="main">
    <div class="dashboard-header clearfix">
        <h2>Kafka Smart Monitoring - Management of embedded alerting framework</h2>
        <p class="description">Use this interface to manage kafka Infrastructure alerting for Kafka</p>
    </div>

    <!--

    Modal windows

    -->

    <!-- Modal window for maintenance enable end time calendar selection -->
    <div class="modal fade" id="enable_maintenance_endtime" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Enabling the maintenance mode</h3>
                </div>
                <div class="modal-body">

                    <p><b>Enable maintenance mode to avoid alerts triggering during your maintenance time window:</b></p>

                    <div class="dateInput">
                        <div style="margin-bottom: 6px">Maintenance modes starts on:</div>
                        <input id="inputStartMaintenance" type="date">
                    </div>
                    <div class="input input-dropdown" id="inputStartMaintenanceTime">
                        <label>At:</label>
                    </div>

                    <br />

                    <div class="dateInput">
                        <div style="margin-bottom: 6px">Maintenance modes ends on:</div>
                        <input id="inputEndMaintenance" type="date">
                    </div>
                    <div class="input input-dropdown" id="inputEndMaintenanceTime">
                        <label>At:</label>
                    </div>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_enable_maintenance_endtime" type="submit" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for grace period modification -->
    <div class="modal fade" id="modal_modify_grace_period" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Grace period update </h3>
                </div>
                <div class="modal-body">
                    <p>Select a grace period value in seconds, and press Ok to update:</p>
                    <div class="input input-dropdown" id="modal_input_grace_period">
                        <label>grace period in seconds:</label>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_grace_period" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window for grace period modification -->
    <div class="modal fade" id="modal_modify_kafka_connector_grace_period" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Grace period update </h3>
                </div>
                <div class="modal-body">
                    <p>Select a grace period value in seconds, and press Ok to update:</p>
                    <div class="input input-dropdown" id="modal_input_kafka_connector_grace_period">
                        <label>grace period in seconds:</label>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_kafka_connector_grace_period" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal window asking for confirmation before deactivating the maintenance mode -->
    <div class="modal fade" id="disabled_maintenance_confirmation" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Disabling the maintenance mode</h3>
                </div>
                <div class="modal-body">

                    <p><b>Do you want to confirm disabling the maintenance mode?</b>
                    <br /><br />
                        Once the maintenance mode will be disabled, all activated alerts will be able to trigger.
                    </p>

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_disable_maintenance_confirmation" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Maintenance mode selection is invalid -->
    <div class="modal fade" id="maintenance_mode_date_is_invalid" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p><b>Invalid entry:</b> the selected date time is in the past or your start / end time selection is invalid, please correct your selection.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Maintenance mode end of date is invalid -->
    <div class="modal fade" id="maintenance_mode_data_is_invalid" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Maintenance mode</h3>
                </div>
                <div class="modal-body">
                    <p><b>Invalid entry:</b> the date / time entries are empty or incorrect, please select a valid end date for the maintenance mode.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update KVstore collection -->
    <div class="modal fade" id="modal_update_collection" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore collection update</h3>
                </div>
                <div class="modal-body">
                    <p>This is perfectly safe and simply runs immediately the scheduled report updating the KVstore collection.<br /><br />
                       If the operation is confirmed, please wait a few seconds for the background job to terminate and the end job window to appear.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_update_collection" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Rebuild KVstore collection -->
    <div class="modal fade" id="modal_rebuild_collection" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore collection rebuild</h3>
                </div>
                <div class="modal-body">
                    <p>All existing configuration will be <b>irremediably lost</b>, the KVstore collection will be flushed and replaced by a fresh update, with default values.<br /><br />
                       If the operation is confirmed, please wait a few seconds for the background job to terminate and the end job window to appear.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_rebuild_collection" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update KVstore collection done -->
    <div class="modal fade" id="modal_update_collection_done" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore collection update</h3>
                </div>
                <div class="modal-body">
                    <p>The KVstore collection was updated successfully. All relevant searches were refreshed.<br /><br />
                        <b>It is recommended to reload the dashboard, using the button bellow.</b>
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_reload" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close & refresh</button>
                </div>
            </div>
        </div>
    </div>

    <!-- maintenance mode disabled -->
    <div class="modal fade" id="modal_maintenance_mode_disabled" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: steelblue;"><span class="glyphicon glyphicon-lock"></span>Maintenance mode has been disabled</h3>
                </div>
                <div class="modal-body">
                    <p><b>The maintenance mode has been successfully disabled.</b><br /><br />
                        Returning to normal operation mode, all of the activated Kafka alerting will be able to trigger starting now. <br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- maintenance mode final message-->
    <div class="modal fade" id="modal_maintenance_mode_confirmed" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Maintenance mode has been enabled</h3>
                </div>
                <div class="modal-body">
                    <p><b>The maintenance mode has been successfully enabled.</b><br /><br />
                        None of the Kafka alerting will be able to trigger during the maintenance time window. <br /><br />
                        The maintenance mode will be automatically deactivated when the end date time configured will be reached.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- maintenance mode final message-->
    <div class="modal fade" id="modal_maintenance_mode_scheduled" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Maintenance mode scheduled</h3>
                </div>
                <div class="modal-body">
                    <p><b>The maintenance mode has been successfully scheduled.</b><br /><br />
                        The scheduled report will automatically enable the maintenance mode according to your request. <br /><br />
                        During the maintenance time window, none of the Kafka alerting wll be able to trigger.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure while attempting to enable or disable the maintenance mode -->
    <div class="modal fade" id="modal_maintenance_mode_failure" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to modify the maintenance mode.<br /><br />
                        <b>You might not have the permission to write to the collection</b>, or an unexpected failure was encountered.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during KVstore collection flush -->
    <div class="modal fade" id="modal_update_collection_failure_flush" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to flush the KVstore collection.<br /><br />
                        <b>You might not have the permission to write to the collection</b>, or an unexpected failure was encountered.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during KVstore collection update -->
    <div class="modal fade" id="modal_update_collection_failure" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to perform the KVstore collection update.<br /><br />
                        <b>You might not have the permission to write to the collection</b>, or an unexpected failure was encountered.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error or failure during KVstore collection update -->
    <div class="modal fade" id="modal_update_collection_failure_return" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while attempting to perform the KVstore collection update.<br /><br />
                        <b>You might not have the permission to write to the collection</b>, or an unexpected failure was encountered.<br /><br />
                        <b>The server returned the following error message:</b>
                    </p>
                    <div class="modal-error-message" style="margin: 10px 0; padding: 10px; border-radius: 3px 3px 3px 3px; color: #D8000C; background-color: #FFBABA;">
                        <p>error return message</p>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error loading the current maintenance mode -->
    <div class="modal fade" id="modal_loading_maintenance_mode_failure" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>Oops!</h3>
                </div>
                <div class="modal-body">
                    <p>Sorry but it looks like an error occurred while loading the current maintenance mode status.
                        <br /><br />
                        Please attempt to refresh the page or review Splunk logs.<br /><br />
                        <b>If the application was just deployed, please make sure Splunk was restarted after the installation.</b>
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic modification -->
    <div class="modal fade" id="modal_entry_modification" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry update</h3>
                </div>
                <div class="modal-body">
                    <p>Confirm modification for this entry?<br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_entry_modification" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic deletion -->
    <div class="modal fade" id="modal_entry_deletion" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry deletion</h3>
                </div>
                <div class="modal-body">
                    <p>Confirm deletion of this entry?<br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button type="submit" id="btn_modal_entry_deletion" class="btn btn-default btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Generic invalid selection -->
    <div class="modal fade" id="modal_entry_update_invalid" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span>KVstore entry selection is invalid</h3>
                </div>
                <div class="modal-body">
                    <p>The selection you have made or the modification you have requested is invalid.<br /><br />
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="submit" id="btn_modal_entry_update_invalid" class="btn btn-primary btn-danger pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Alerts -->
    <div id="main_modal_manage_kafka_alerts" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_kafka_alerts" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token subsitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_kafka_alerts">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for alert:<br /> <span style="color: steelblue">$tk_kafka_alert_title$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>Cron Schedule:</b> $tk_kafka_alert_cron_schedule$</p>
                                    <p><b>Schedule window:</b> $tk_kafka_alert_schedule_window$</p>
                                    <p><b>Suppress fields:</b> $tk_kafka_alert_suppress_fields$</p>
                                    <p><b>Suppress period:</b> $tk_kafka_alert_suppress_period$</p>
                                    <p><b>Disabled:</b> $tk_kafka_alert_disabled$</p>
                                    <p><b>Next scheduled time:</b> $tk_kafka_alert_next_scheduled_time$</p><br>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Close</button>
                            <a class="btn btn-primary" id="btn_url_modal_manage_kafka_alert" target="_blank" href="alert_url" role="button">Review and edit alert</a>
                            <a class="btn btn-primary" id="btn_url_modal_history_kafka_alert" target="_blank" href="alert_url" role="button">Search alert history</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for kafka infrastructure -->
    <div id="main_modal_manage_kafka_infra1" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_kafka_infra1" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_kafka_infra1">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for entity: <span style="color: steelblue">$tk_kafka_infra_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>Name:</b> $tk_kafka_infra_name$</p>
                                    <p><b>Env:</b> $tk_kafka_infra_env$</p>
                                    <p><b>Label:</b> $tk_kafka_infra_label$</p>
                                    <p><b>Keyid:</b> $tk_kafka_infra_keyid$</p>
                                    <p><b>Current monitoring state:</b> $tk_kafka_infra_monitoring_state$</p>
                                    <p><b>Current grace period:</b> $tk_kafka_infra_grace_period$ seconds</p><br>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Close</button>
                            <button type="submit" id="btn_modify_modal_manage_kafka_infra1" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            <button type="submit" id="btn_enable_modal_manage_kafka_infra1" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            <button type="submit" id="btn_disable_modal_manage_kafka_infra1" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            <button type="submit" id="btn_delete_modal_manage_kafka_infra1" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for kafka infrastructure nodes number -->
    <div id="main_modal_manage_kafka_infra_nodes" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_kafka_infra_nodes" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_kafka_infra_nodes">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for role: <span style="color: steelblue">$tk_kafka_infra_nodes_role$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>Role:</b> $tk_kafka_infra_nodes_role$</p>
                                    <p><b>Env:</b> $tk_kafka_infra_nodes_env$</p>
                                    <p><b>Label:</b> $tk_kafka_infra_nodes_label$</p>
                                    <p><b>Keyid:</b> $tk_kafka_infra_nodes_keyid$</p>
                                    <p><b>Current monitoring state:</b> $tk_kafka_infra_nodes_monitoring_state$</p>
                                    <p><b>Current number of nodes:</b> $tk_kafka_infra_nodes_current_nodes_number$</p>
                                    <p><b>Current minimal number of nodes:</b> $tk_kafka_infra_nodes_minimal_nodes_number$</p><br>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Close</button>
                            <button type="submit" id="btn_modify_modal_manage_kafka_infra_nodes" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            <button type="submit" id="btn_enable_modal_manage_kafka_infra_nodes" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            <button type="submit" id="btn_disable_modal_manage_kafka_infra_nodes" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            <button type="submit" id="btn_delete_modal_manage_kafka_infra_nodes" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for kafka topics -->
    <div id="main_modal_manage_kafka_topics" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_kafka_topics" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_kafka_topics">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for Kafka topic: <span style="color: steelblue">$tk_kafka_topic_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>Name:</b> $tk_kafka_topic_name$</p>
                                    <p><b>Env:</b> $tk_kafka_topic_env$</p>
                                    <p><b>Label:</b> $tk_kafka_topic_label$</p>
                                    <p><b>Keyid:</b> $tk_kafka_topic_keyid$</p>
                                    <p><b>Current monitoring state:</b> $tk_kafka_topic_monitoring_state$</p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Close</button>
                            <button type="submit" id="btn_enable_modal_manage_kafka_topic" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            <button type="submit" id="btn_disable_modal_manage_kafka_topic" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            <button type="submit" id="btn_delete_modal_manage_kafka_topic" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for kafka Connect -->
    <div id="main_modal_manage_kafka_connector" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_kafka_connector" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_kafka_connector">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for Kafka Connector: <span style="color: steelblue">$tk_kafka_connector_name$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>Name:</b> $tk_kafka_connector_name$</p>
                                    <p><b>Role:</b> $tk_kafka_connector_role$</p>
                                    <p><b>Env:</b> $tk_kafka_connector_env$</p>
                                    <p><b>Label:</b> $tk_kafka_connector_label$</p>
                                    <p><b>Keyid:</b> $tk_kafka_connector_keyid$</p>
                                    <p><b>Current monitoring state:</b> $tk_kafka_connector_monitoring_state$</p>
                                    <p><b>Current grace period:</b> $tk_kafka_connector_grace_period$ seconds</p><br>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Close</button>
                            <button type="submit" id="btn_modify_modal_manage_kafka_connector" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Modify</button>
                            <button type="submit" id="btn_enable_modal_manage_kafka_connector" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            <button type="submit" id="btn_disable_modal_manage_kafka_connector" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            <button type="submit" id="btn_delete_modal_manage_kafka_connector" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal drilldown context for Kafka Burrow consumers -->
    <div id="main_modal_manage_kafka_consumers" class="dashboard-element html" style="width: 100%">
        <div class="panel-body html">
            <div class="modal fade" id="modal_manage_kafka_consumers" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <!-- This is required to get the token substitutions without affecting the buttons actions in js -->
                        <div class="dashboard-element html" id="body_modal_manage_kafka_consumers">
                            <div class="panel-body html">
                                <div class="modal-header">
                                    <h3>Actions for consumer group: <span style="color: steelblue">$tk_burrow_group$</span></h3>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body" style="display:grid;">
                                    <p><b>Group consumer:</b> $tk_burrow_group$</p>
                                    <p><b>Cluster:</b> $tk_burrow_cluster$</p>
                                    <p><b>Env:</b> $tk_burrow_env$</p>
                                    <p><b>Label:</b> $tk_burrow_label$</p>
                                    <p><b>Keyid:</b> $tk_burrow_keyid$</p>
                                    <p><b>Current monitoring state:</b> $tk_burrow_monitoring_state$</p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>Close</button>
                            <button type="submit" id="btn_enable_modal_manage_kafka_consumer" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Enable</button>
                            <button type="submit" id="btn_disable_modal_manage_kafka_consumer" class="btn btn-primary btn-default"><span class="glyphicon glyphicon-remove"></span>Disable</button>
                            <button type="submit" id="btn_delete_modal_manage_kafka_consumer" role="button" class="btn btn-danger btn-default"><span class="glyphicon glyphicon-remove"></span>Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal window for grace period modification -->
    <div class="modal fade" id="modal_modify_minimal_nodes_number" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 style="color: indianred;"><span class="glyphicon glyphicon-lock"></span> Grace period update </h3>
                </div>
                <div class="modal-body">
                    <p>Enter the minimal nodes number for this role, and press Ok to update:</p>
                <div class="fieldset">
                    <div class="input input-text" id="modal_input_minimal_nodes_number">
                        <label>Minimal nodes number</label>
                    </div>
                </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
                    <button id="btn_modal_modify_minimal_nodes_number" type="submit" class="btn btn-default btn-primary pull-right" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Ok</button>
                </div>
            </div>
        </div>
    </div>

    <!--

    End of modal windows

    -->

    <div id="row_maintenance_state" class="dashboard-row dashboard-row_maintenance_state">
        <div id="panel_maintenance_state" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="element_maintenance_state" class="dashboard-element single" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_maintenance_state_reactivation" class="dashboard-row dashboard-row_maintenance_state_reactivation" data-depends="$maintenance_enabled$">
        <div id="panel_maintenance_state_reactivation" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="element_maintenance_state_reactivation" class="dashboard-element single" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_maintenance_state_scheduled" class="dashboard-row dashboard-row_maintenance_state_scheduled" data-depends="$maintenance_scheduled$">
        <div id="panel_maintenance_state_scheduled" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="element_maintenance_state_scheduled" class="dashboard-element single" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_maintenance" class="dashboard-row dashboard-row_maintenance">
        <div id="panel_maintenance_enable" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_enable_maintenance">
                        <button id="btn_press_enable_maintenance" class="btn btn-danger submit">Enable maintenance mode</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="panel_maintenance_disable" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_disable_maintenance">
                        <button id="btn_press_disable_maintenance" class="btn btn-primary submit">Disable maintenance mode</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_linkinput" class="dashboard-row dashboard-row_linkinput">
        <div id="panel_linkinput" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">
                <div class="fieldset">
                    <div class="input input-linklist" id="inputlink1">
                        <label>&nbsp;</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="row-alerts-help" class="dashboard-row dashboard-row-kafka-alerts-help" data-depends="$selection1$">
        <div id="panel-alerts-help" class="dashboard-cell" style="width: 100%;" data-original-id="panel1">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="element-alerts-help" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">
                            <h1>Kafka infrastructure monitoring help - Summary configuration of embedded alerts</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_kafka_alerts_delete" class="dashboard-row dashboard-row_kafka_alerts" data-depends="$selection1$">
        <div id="panel_show_kafka_alerts" class="dashboard-cell" style="width: 100%;" data-original-id="panel_show_kafka_alerts">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Embedded alerts: click on a table row to access object contextual actions</h2>
                <div style="margin-left: 10px; margin-bottom: 10px;" id="btn_refresh_kafka_alerts">
                    <button class="btn btn-primary submit">Refresh this table</button>
                </div>
                <div class="panel-element-row">
                    <div id="element_kafka_alerts_main_table" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row-infra-help" class="dashboard-row dashboard-row-kafka-infra-help" data-depends="$selection2$">
        <div id="panel-infra-help" class="dashboard-cell" style="width: 100%;" data-original-id="panel1">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="element-infra-help" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">

                            <h1>Kafka infrastructure monitoring help - Stale metric monitoring per component</h1>

                            <p>The KVstore collection defines the state of alerting for a given entity, though the following items:

                                <lu>
                                    <li><b>monitoring_state:</b> only enabled entities will trigger when alerts conditions are met, such as a component being down or unreachable.</li>
                                    <li><b>grace_period:</b> a minimal grace period in seconds that will be applied before the alert triggers. (for metrics availability test only)</li>
                                </lu>

                            <br />

                            Use the update collection button to immediately run the components discovery report, or use the reset button to flush and reset the state of the collection.

                            </p>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_manage_kafka_infra" class="dashboard-row dashboard-row_maintenance" data-depends="$selection2$">
        <div id="panel_manage_kafka_infra1" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_infra1">
                        <button class="btn btn-primary submit">Update the collection now</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="panel_manage_kafka_infra2" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_infra2">
                        <button class="btn btn-primary submit">Reset the collection now</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_kafka_infra_single" class="dashboard-row dashboard-row_connect_single" data-depends="$selection2$">
        <div id="panel_kafka_infra_single" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="element_kafka_infra_single1" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_kafka_infra_single2" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_kafka_infra_single3" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="row_kafka_infra_search" class="dashboard-row dashboard-row_kafka_infra_search" data-depends="$selection2$">
        <div id="panel_togglepanel_true_search_kafka_infra" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_search_kafka_infra">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search and filter</h2>
                <div class="fieldset">
                    <div class="input input-text" id="input_kafka_infra_search_name">
                        <label>name:</label>
                    </div>
                    <div class="input input-dropdown" id="input_kafka_infra_search_env">
                        <label>Environment:</label>
                    </div>
                    <div class="input input-dropdown" id="input_kafka_infra_search_label">
                        <label>Label:</label>
                    </div>
                    <div class="input input-dropdown" id="input_kafka_infra_search_role">
                        <label>type of component:</label>
                    </div>
                    <div class="input input-dropdown" id="input_kafka_infra_search_monitoring_state">
                        <label>Monitoring state:</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="row_kafka_infra_delete" class="dashboard-row dashboard-row_kafka_infra_delete" data-depends="$selection2$">
        <div id="panel_togglepanel_true_show_kafka_infra" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_show_kafka_infra">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Collection content: click on a table row to access object contextual actions</h2>
                <div class="panel-element-row">
                    <div id="element_kafka_infra_main_table" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row-infra-nodenumber-help" class="dashboard-row dashboard-row-kafka-infra-help" data-depends="$selection3$">
        <div id="panel-infra-nodenumber-help" class="dashboard-cell" style="width: 100%;" data-original-id="panel1">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="element-infra-nodenumber-help" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">

                            <h1>Kafka infrastructure monitoring help - Stale metric monitoring per number of active nodes</h1>

                            <p>The KVstore collection defines the state of alerting for a type of component, though the following items:

                                <lu>
                                    <li><b>monitoring_state:</b> only enabled entities will trigger when alerts conditions are met, such as a component being down or unreachable.</li>
                                    <li><b>minimal_nodes_number:</b> the minimal number of nodes that should be active concurrently for a given type of component.</li>
                                </lu>

                            <br />

                            The stale metric monitoring per number is specially valuable in a container environment where the identity of instances is expected to change with the life cycle of containers.

                            <br />

                            Use the update collection button to immediately run the components discovery report, or use the reset button to flush and reset the state of the collection.

                            </p>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_manage_kafka_infra_nodenumber" class="dashboard-row dashboard-row_maintenance" data-depends="$selection3$">
        <div id="panel_manage_kafka_infra_nodenumber1" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_infra_nodenumber1">
                        <button class="btn btn-primary submit">Update the collection now</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="panel_manage_kafka_infra_nodenumber2" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_infra_nodenumber2">
                        <button class="btn btn-primary submit">Reset the collection now</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_kafka_infra_nodes_single" class="dashboard-row dashboard-row_connect_single" data-depends="$selection3$">
        <div id="panel_kafka_infra_nodes_single" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="element_kafka_infra_nodes_single1" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_kafka_infra_nodes_single2" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_kafka_infra_nodes_single3" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_kafka_infra_nodes_search" class="dashboard-row dashboard-row_kafka_infra_search" data-depends="$selection3$">
        <div id="panel_togglepanel_true_search_kafka_infra_nodes" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_search_kafka_infra">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search and filter</h2>
                <div class="fieldset">
                    <div class="input input-dropdown" id="input_kafka_infra_nodes_search_env">
                        <label>Environment:</label>
                    </div>
                    <div class="input input-dropdown" id="input_kafka_infra_nodes_search_label">
                        <label>Label:</label>
                    </div>
                    <div class="input input-dropdown" id="input_kafka_infra_nodes_search_role">
                        <label>type of component:</label>
                    </div>
                    <div class="input input-dropdown" id="input_kafka_infra_nodes_search_monitoring_state">
                        <label>Monitoring state:</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="row_kafka_infra_nodes_delete" class="dashboard-row dashboard-row_kafka_infra_delete" data-depends="$selection3$">
        <div id="panel_togglepanel_true_show_kafka_infra_nodes" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_show_kafka_infra_nodes">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Collection content: click on a table row to access object contextual actions</h2>
                <div class="panel-element-row">
                    <div id="element_kafka_infra_nodes_main_table" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row-infra-topics-help" class="dashboard-row dashboard-row-kafka-infra-help" data-depends="$selection4$">
        <div id="panel-infra-topics-help" class="dashboard-cell" style="width: 100%;" data-original-id="panel1">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="element-infra-topics-help" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">

                            <h1>Kafka infrastructure monitoring help - Topics monitoring</h1>

                            <p>The KVstore collection defines the state of alerting for Kafka topics, though the following item(s):

                                <lu>
                                    <li><b>monitoring_state:</b> only enabled entities will trigger when alerts conditions are met, such as a component being down or unreachable.</li>
                                </lu>

                            <br />

                            Use the update collection button to immediately run the components discovery report, or use the reset button to flush and reset the state of the collection.

                            </p>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_manage_kafka_topics" class="dashboard-row dashboard-row_maintenance" data-depends="$selection4$">
        <div id="panel_manage_kafka_topics1" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_topics1">
                        <button class="btn btn-primary submit">Update the collection now</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="panel_manage_kafka_topics2" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_topics2">
                        <button class="btn btn-primary submit">Reset the collection now</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_kafka_topics_single" class="dashboard-row dashboard-row_connect_single" data-depends="$selection4$">
        <div id="panel_kafka_topics_single" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="element_kafka_topics_single1" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_kafka_topics_single2" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_kafka_topics_single3" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_kafka_topics_search" class="dashboard-row dashboard-row_kafka_topics_search" data-depends="$selection4$">
        <div id="panel_togglepanel_true_search_kafka_topics" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_search_kafka_topics">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search and filter</h2>
                <div class="fieldset">
                    <div class="input input-text" id="input_kafka_topics_search_env">
                        <label>env:</label>
                    </div>
                    <div class="input input-text" id="input_kafka_topics_search_label">
                        <label>label:</label>
                    </div>
                    <div class="input input-text" id="input_kafka_topics_search_name">
                        <label>name:</label>
                    </div>
                    <div class="input input-dropdown" id="input_kafka_topics_search_monitoring_state">
                        <label>Monitoring state:</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="row_kafka_topics_delete" class="dashboard-row dashboard-row_kafka_topics_delete" data-depends="$selection4$">
        <div id="panel_togglepanel_true_show_kafka_topics" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_show_kafka_topics">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Collection content: click on a table row to access object contextual actions</h2>
                <div class="panel-element-row">
                    <div id="element_kafka_topics_main_table" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row-infra-connect-help" class="dashboard-row dashboard-row-kafka-infra-help" data-depends="$selection5$">
        <div id="panel-infra-connect-help" class="dashboard-cell" style="width: 100%;" data-original-id="panel1">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="element-infra-connect-help" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">

                            <h1>Kafka infrastructure monitoring help - Kafka Connect tasks monitoring</h1>

                            <p>The KVstore collection defines the state of alerting for Kafka Connect connectors and tasks, though the following item(s):

                                <lu>
                                    <li><b>monitoring_state:</b> only enabled entities will trigger when alerts conditions are met, such as a component being down or unreachable.</li>
                                    <li><b>grace_period:</b> a minimal grace period in seconds that will be applied before the alert triggers.
                                </lu>

                            <br />
                            <br />

                            Use the update collection button to immediately run the components discovery report, or use the reset button to flush and reset the state of the collection.

                            </p>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_manage_kafka_connect" class="dashboard-row dashboard-row_maintenance" data-depends="$selection5$">
        <div id="panel_manage_kafka_connect1" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_connect1">
                        <button class="btn btn-primary submit">Update the collection now</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="panel_manage_kafka_connect2" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_connect2">
                        <button class="btn btn-primary submit">Reset the collection now</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_connect_single" class="dashboard-row dashboard-row_connect_single" data-depends="$selection5$">
        <div id="panel_connect_single" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="element_connect_single1" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_connect_single2" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_connect_single3" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_connect_search" class="dashboard-row dashboard-row_connect_search" data-depends="$selection5$">
        <div id="panel_togglepanel_true_search" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_search">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search and filter</h2>
                <div class="fieldset">
                    <div class="input input-text" id="input_connect_search_env">
                        <label>env:</label>
                    </div>
                    <div class="input input-text" id="input_connect_search_label">
                        <label>label:</label>
                    </div>
                    <div class="input input-text" id="input_connect_search_connector">
                        <label>connector:</label>
                    </div>
                    <div class="input input-dropdown" id="input_connect_search_task">
                        <label>type of task:</label>
                    </div>
                    <div class="input input-dropdown" id="input_connect_search_monitoring_state">
                        <label>Monitoring state:</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="row_connect_delete" class="dashboard-row dashboard-row_connect_delete" data-depends="$selection5$">
        <div id="panel_togglepanel_true_show_connect" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_show_connect">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Collection content: click on a table row to access object contextual actions</h2>
                <div class="panel-element-row">
                    <div id="element_connect_main_table" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--
    Burrow
    -->

    <div id="row-infra-consumers-help" class="dashboard-row dashboard-row-kafka-infra-help" data-depends="$selection6$">
        <div id="panel-infra-consumers-help" class="dashboard-cell" style="width: 100%;" data-original-id="panel1">
            <div class="dashboard-panel clearfix">
                <div class="panel-element-row">
                    <div id="element-infra-consumers-help" class="dashboard-element html" style="width: 100%">
                        <div class="panel-body html">

                            <h1>Kafka infrastructure monitoring help - Consumers monitoring with Burrow</h1>

                            <p>The KVstore collection defines the state of alerting for Kafka Consumers, though the following item(s):

                                <lu>
                                    <li><b>monitoring_state:</b> only enabled entities will trigger when alerts conditions are met, such as a component being down or unreachable.</li>
                                </lu>

                            <br />

                            Use the update collection button to immediately run the components discovery report, or use the reset button to flush and reset the state of the collection.

                            </p>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_manage_kafka_consumers" class="dashboard-row dashboard-row_maintenance" data-depends="$selection6$">
        <div id="panel_manage_kafka_consumers1" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_consumers1">
                        <button class="btn btn-primary submit">Update the collection now</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="panel_manage_kafka_consumers2" class="dashboard-cell" style="width: 50%;">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title"></h2>
                <div class="fieldset" style="text-align: center;">
                    <div class="form-submit" id="btn_manage_content_kafka_consumers2">
                        <button class="btn btn-primary submit">Reset the collection now</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_burrow_single" class="dashboard-row dashboard-row_burrow_single" data-depends="$selection6$">
        <div id="panel_burrow_single" class="dashboard-cell" style="width: 100%;">
            <div class="dashboard-panel clearfix">

                <div class="panel-element-row">
                    <div id="element_burrow_single1" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_burrow_single2" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                    <div id="element_burrow_single3" class="dashboard-element single" style="width: 33.33%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="row_burrow_search" class="dashboard-row dashboard-row_burrow_search" data-depends="$selection6$">
        <div id="panel_togglepanel_true_search_burrow" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_search_burrow">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Search and filter</h2>
                <div class="fieldset">
                    <div class="input input-text" id="input_burrow_search_env">
                        <label>env:</label>
                    </div>
                    <div class="input input-text" id="input_burrow_search_label">
                        <label>label:</label>
                    </div>
                    <div class="input input-text" id="input_burrow_search_cluster">
                        <label>cluster:</label>
                    </div>
                    <div class="input input-text" id="input_burrow_search_name">
                        <label>name:</label>
                    </div>
                    <div class="input input-dropdown" id="input_burrow_search_monitoring_state">
                        <label>Monitoring state:</label>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="row_burrow_delete" class="dashboard-row dashboard-row_burrow_delete" data-depends="$selection6$">
        <div id="panel_togglepanel_true_show_burrow" class="dashboard-cell" style="width: 100%;" data-original-id="panel_togglepanel_true_show_burrow">
            <div class="dashboard-panel clearfix">
                <h2 class="panel-title">Collection content: click on a table row to access object contextual actions</h2>
                <div class="panel-element-row">
                    <div id="element_burrow_main_table" class="dashboard-element table" style="width: 100%">
                        <div class="panel-body"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<!--
END LAYOUT
-->

<script src="{{SPLUNKWEB_URL_PREFIX}}/config?autoload=1" crossorigin="use-credentials"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/js/i18n.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/i18ncatalog?autoload=1"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/build/simplexml/index.js"></script>
<script type="text/javascript">
// <![CDATA[
// <![CDATA[
//
// LIBRARY REQUIREMENTS
//
// In the require function, we include the necessary libraries and modules for
// the HTML dashboard. Then, we pass variable names for these libraries and
// modules as function parameters, in order.
//
// When you add libraries or modules, remember to retain this mapping order
// between the library or module and its function parameter. You can do this by
// adding to the end of these lists, as shown in the commented examples below.
require([
        "splunkjs/mvc",
        "splunkjs/mvc/utils",
        "splunkjs/mvc/tokenutils",
        "underscore",
        "jquery",
        "splunkjs/mvc/simplexml",
        "splunkjs/mvc/layoutview",
        "splunkjs/mvc/simplexml/dashboardview",
        "splunkjs/mvc/simplexml/dashboard/panelref",
        "splunkjs/mvc/simplexml/element/chart",
        "splunkjs/mvc/simplexml/element/event",
        "splunkjs/mvc/simplexml/element/html",
        "splunkjs/mvc/simplexml/element/list",
        "splunkjs/mvc/simplexml/element/map",
        "splunkjs/mvc/simplexml/element/single",
        "splunkjs/mvc/simplexml/element/table",
        "splunkjs/mvc/simplexml/element/visualization",
        "splunkjs/mvc/simpleform/formutils",
        "splunkjs/mvc/simplexml/eventhandler",
        "splunkjs/mvc/simplexml/searcheventhandler",
        "splunkjs/mvc/simpleform/input/dropdown",
        "splunkjs/mvc/simpleform/input/radiogroup",
        "splunkjs/mvc/simpleform/input/linklist",
        "splunkjs/mvc/simpleform/input/multiselect",
        "splunkjs/mvc/simpleform/input/checkboxgroup",
        "splunkjs/mvc/simpleform/input/text",
        "splunkjs/mvc/simpleform/input/timerange",
        "splunkjs/mvc/simpleform/input/submit",
        "splunkjs/mvc/searchmanager",
        "splunkjs/mvc/savedsearchmanager",
        "splunkjs/mvc/postprocessmanager",
        "splunkjs/mvc/simplexml/urltokenmodel"
        // Add comma-separated libraries and modules manually here, for example:
        // ..."splunkjs/mvc/simplexml/urltokenmodel",
        // "splunkjs/mvc/tokenforwarder"
    ],
    function(
        mvc,
        utils,
        TokenUtils,
        _,
        $,
        DashboardController,
        LayoutView,
        Dashboard,
        PanelRef,
        ChartElement,
        EventElement,
        HtmlElement,
        ListElement,
        MapElement,
        SingleElement,
        TableElement,
        VisualizationElement,
        FormUtils,
        EventHandler,
        SearchEventHandler,
        DropdownInput,
        RadioGroupInput,
        LinkListInput,
        MultiSelectInput,
        CheckboxGroupInput,
        TextInput,
        TimeRangeInput,
        SubmitButton,
        SearchManager,
        SavedSearchManager,
        PostProcessManager,
        UrlTokenModel

        // Add comma-separated parameter names here, for example:
        // ...UrlTokenModel,
        // TokenForwarder
    ) {

        var pageLoading = true;


        //
        // FUNCTIONS
        //

        // Returns true if numeric
        function isNumeric(n) {
            return !isNaN(parseFloat(n)) && isFinite(n) && n > 0;
        }

        //
        // TOKENS
        //

        // Create token namespaces
        var urlTokenModel = new UrlTokenModel();
        mvc.Components.registerInstance('url', urlTokenModel);
        var defaultTokenModel = mvc.Components.getInstance('default', {
            create: true
        });
        var submittedTokenModel = mvc.Components.getInstance('submitted', {
            create: true
        });

        urlTokenModel.on('url:navigate', function() {
            defaultTokenModel.set(urlTokenModel.toJSON());
            if (!_.isEmpty(urlTokenModel.toJSON()) && !_.all(urlTokenModel.toJSON(), _.isUndefined)) {
                submitTokens();
            } else {
                submittedTokenModel.clear();
            }
        });

        // Initialize tokens
        defaultTokenModel.set(urlTokenModel.toJSON());

        function submitTokens() {
            // Copy the contents of the defaultTokenModel to the submittedTokenModel and urlTokenModel
            FormUtils.submitForm({
                replaceState: pageLoading
            });
        }

        function setToken(name, value) {
            defaultTokenModel.set(name, value);
            submittedTokenModel.set(name, value);
        }

        function unsetToken(name) {
            defaultTokenModel.unset(name);
            submittedTokenModel.unset(name);
        }

        //
        // INIT
        //

        // Unused currently
        // defaultTokenModel.set({
        //    <my_token>: '<my_value>'
        // });

        //
        // COMMON BUTTONS
        //

        $("#btn_modal_reload").click(function() {
            document.location.reload()
        });

        //
        // SEARCH MANAGERS
        //

        //
        // ALERT SUMMARY
        //

        var search_kafka_alerts_main_table = new SearchManager({
            "id": "search_kafka_alerts_main_table",
            "sample_ratio": 1,
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "search": "| rest splunk_server=local /servicesNS/-/telegraf-kafka/saved/searches | search eai:acl.app=\"telegraf-kafka\" alert.track=1 | fields title, cron_schedule, schedule_window, alert.suppress.fields, alert.suppress.period, disabled, next_scheduled_time, id | rex field=id \"saved/searches/(?<id>.*)\" | sort limit=0 title | eval \" \" = \"icon|\" + if(disabled==\"0\",\"ico_good ico_small|icon-check|Up\", \"ico_error ico_small|icon-close|Down\")",
            "latest_time": "now",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        //
        // MAINTENANCE MODE
        //

        var search_maintenance_mode_mainsearch = new SearchManager({
            "id": "search_maintenance_mode_mainsearch",
            "sample_ratio": 1,
            "search": "| inputlookup kafka_alerting_maintenance | eval maintenance_mode=if(now()<maintenance_mode_start AND maintenance_mode_end>now(), \"scheduled\", maintenance_mode)",
            "status_buckets": 0,
            "earliest_time": "-24h@h",
            "cancelOnUnload": true,
            "latest_time": "now",
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        new SearchEventHandler({
            managerid: "search_maintenance_mode_mainsearch",
            event: "progress",
            conditions: [{
                    attr: "match",
                    value: "'result.maintenance_mode'==\"enabled\"",
                    actions: [{
                        "type": "set",
                        "token": "maintenance_enabled",
                        "value": "true"
                    },
                    {
                        "type": "unset",
                        "token": "maintenance_scheduled"
                    }]
                },
                {
                    attr: "match",
                    value: "'result.maintenance_mode'==\"scheduled\"",
                    actions: [{
                        "type": "set",
                        "token": "maintenance_scheduled",
                        "value": "true"
                    },
                    {
                        "type": "unset",
                        "token": "maintenance_enabled"
                    }]
                },
                {
                    attr: "match",
                    value: "'result.maintenance_mode'==\"disabled\"",
                    actions: [{
                        "type": "unset",
                        "token": "maintenance_scheduled"
                    },
                    {
                        "type": "unset",
                        "token": "maintenance_enabled"
                    }]
                }
            ]
        });

        var search_maintenance_state = new PostProcessManager({
            "managerid": "search_maintenance_mode_mainsearch",
            "id": "search_maintenance_state",
            "search": "fields maintenance_mode | eval maintenance=case(match(maintenance_mode, \"enabled\"), 1, match(maintenance_mode, \"disabled\"), 0, match(maintenance_mode, \"scheduled\"), 2), maintenance_mode=upper(maintenance_mode) | rangemap field=maintenance low=0-0 severe=1-1 high=2-2 default=severe",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_maintenance_state_reactivation = new PostProcessManager({
            "managerid": "search_maintenance_mode_mainsearch",
            "id": "search_maintenance_state_reactivation",
            "search": "eval maintenance_mode_end=strftime(maintenance_mode_end, \"%d %b %H:%M\") | eval maintenance = \"Ends on: \" . maintenance_mode_end | fields maintenance",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_maintenance_state_scheduled = new PostProcessManager({
            "managerid": "search_maintenance_mode_mainsearch",
            "id": "search_maintenance_state_scheduled",
            "search": "eval maintenance_mode_start=strftime(maintenance_mode_start, \"%d %b %H:%M\"), maintenance_mode_end=strftime(maintenance_mode_end, \"%d %b %H:%M\") | eval maintenance = \"Starts on: \" . maintenance_mode_start . \" / \" . \"Ends on: \" . maintenance_mode_end | fields maintenance",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // start time maintenance mode
        var inputStartMaintenanceTime = new DropdownInput({
            "id": "inputStartMaintenanceTime",
            "choices": [{
                    "value": "now",
                    "label": "now"
                },
                {
                    "value": "00:00",
                    "label": "12:00am"
                },
                {
                    "value": "00:30",
                    "label": "12:30am"
                },
                {
                    "value": "01:00",
                    "label": "01:00am"
                },
                {
                    "value": "01:30",
                    "label": "01:30am"
                },
                {
                    "value": "02:00",
                    "label": "02:00am"
                },
                {
                    "value": "02:30",
                    "label": "02:30am"
                },
                {
                    "value": "03:00",
                    "label": "03:00am"
                },
                {
                    "value": "03:30",
                    "label": "03:30am"
                },
                {
                    "value": "04:00",
                    "label": "04:00am"
                },
                {
                    "value": "04:30",
                    "label": "04:30am"
                },
                {
                    "value": "05:00",
                    "label": "05:00am"
                },
                {
                    "value": "05:30",
                    "label": "05:30am"
                },
                {
                    "value": "06:00",
                    "label": "06:00am"
                },
                {
                    "value": "06:30",
                    "label": "06:30am"
                },
                {
                    "value": "07:00",
                    "label": "07:00am"
                },
                {
                    "value": "07:30",
                    "label": "07:30am"
                },
                {
                    "value": "08:00",
                    "label": "08:00am"
                },
                {
                    "value": "08:30",
                    "label": "08:30am"
                },
                {
                    "value": "09:00",
                    "label": "09:00am"
                },
                {
                    "value": "09:30",
                    "label": "09:30am"
                },
                {
                    "value": "10:00",
                    "label": "10:00am"
                },
                {
                    "value": "10:30",
                    "label": "10:30am"
                },
                {
                    "value": "11:00",
                    "label": "11:00am"
                },
                {
                    "value": "11:30",
                    "label": "11:30am"
                },
                {
                    "value": "12:00",
                    "label": "12:00pm"
                },
                {
                    "value": "12:30",
                    "label": "12:30pm"
                },
                {
                    "value": "13:00",
                    "label": "01:00pm"
                },
                {
                    "value": "13:30",
                    "label": "01:30pm"
                },
                {
                    "value": "14:00",
                    "label": "02:00pm"
                },
                {
                    "value": "14:30",
                    "label": "02:30pm"
                },
                {
                    "value": "15:00",
                    "label": "03:00pm"
                },
                {
                    "value": "15:30",
                    "label": "03:30pm"
                },
                {
                    "value": "16:00",
                    "label": "04:00pm"
                },
                {
                    "value": "16:30",
                    "label": "04:30pm"
                },
                {
                    "value": "17:00",
                    "label": "05:00pm"
                },
                {
                    "value": "17:30",
                    "label": "05:30pm"
                },
                {
                    "value": "18:00",
                    "label": "06:00pm"
                },
                {
                    "value": "18:30",
                    "label": "06:30pm"
                },
                {
                    "value": "19:00",
                    "label": "07:00pm"
                },
                {
                    "value": "19:30",
                    "label": "07:30pm"
                },
                {
                    "value": "20:00",
                    "label": "08:00pm"
                },
                {
                    "value": "20:30",
                    "label": "08:30pm"
                },
                {
                    "value": "21:00",
                    "label": "09:00pm"
                },
                {
                    "value": "21:30",
                    "label": "09:30pm"
                },
                {
                    "value": "22:00",
                    "label": "10:00pm"
                },
                {
                    "value": "22:30",
                    "label": "10:30pm"
                },
                {
                    "value": "23:00",
                    "label": "11:00pm"
                },
                {
                    "value": "23:30",
                    "label": "11:30pm"
                }
            ],
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "now",
            "showClearButton": true,
            "value": "$form.time_start_maintenance$",
            "el": $('#inputStartMaintenanceTime')
        }, {
            tokens: true
        }).render();

        inputStartMaintenanceTime.on("change", function(newValue) {
            FormUtils.handleValueChange(inputStartMaintenanceTime);
        });

        // end time maintenance mode
        var inputEndMaintenanceTime = new DropdownInput({
            "id": "inputEndMaintenanceTime",
            "choices": [{
                    "value": "00:00",
                    "label": "12:00am"
                },
                {
                    "value": "00:30",
                    "label": "12:30am"
                },
                {
                    "value": "01:00",
                    "label": "01:00am"
                },
                {
                    "value": "01:30",
                    "label": "01:30am"
                },
                {
                    "value": "02:00",
                    "label": "02:00am"
                },
                {
                    "value": "02:30",
                    "label": "02:30am"
                },
                {
                    "value": "03:00",
                    "label": "03:00am"
                },
                {
                    "value": "03:30",
                    "label": "03:30am"
                },
                {
                    "value": "04:00",
                    "label": "04:00am"
                },
                {
                    "value": "04:30",
                    "label": "04:30am"
                },
                {
                    "value": "05:00",
                    "label": "05:00am"
                },
                {
                    "value": "05:30",
                    "label": "05:30am"
                },
                {
                    "value": "06:00",
                    "label": "06:00am"
                },
                {
                    "value": "06:30",
                    "label": "06:30am"
                },
                {
                    "value": "07:00",
                    "label": "07:00am"
                },
                {
                    "value": "07:30",
                    "label": "07:30am"
                },
                {
                    "value": "08:00",
                    "label": "08:00am"
                },
                {
                    "value": "08:30",
                    "label": "08:30am"
                },
                {
                    "value": "09:00",
                    "label": "09:00am"
                },
                {
                    "value": "09:30",
                    "label": "09:30am"
                },
                {
                    "value": "10:00",
                    "label": "10:00am"
                },
                {
                    "value": "10:30",
                    "label": "10:30am"
                },
                {
                    "value": "11:00",
                    "label": "11:00am"
                },
                {
                    "value": "11:30",
                    "label": "11:30am"
                },
                {
                    "value": "12:00",
                    "label": "12:00pm"
                },
                {
                    "value": "12:30",
                    "label": "12:30pm"
                },
                {
                    "value": "13:00",
                    "label": "01:00pm"
                },
                {
                    "value": "13:30",
                    "label": "01:30pm"
                },
                {
                    "value": "14:00",
                    "label": "02:00pm"
                },
                {
                    "value": "14:30",
                    "label": "02:30pm"
                },
                {
                    "value": "15:00",
                    "label": "03:00pm"
                },
                {
                    "value": "15:30",
                    "label": "03:30pm"
                },
                {
                    "value": "16:00",
                    "label": "04:00pm"
                },
                {
                    "value": "16:30",
                    "label": "04:30pm"
                },
                {
                    "value": "17:00",
                    "label": "05:00pm"
                },
                {
                    "value": "17:30",
                    "label": "05:30pm"
                },
                {
                    "value": "18:00",
                    "label": "06:00pm"
                },
                {
                    "value": "18:30",
                    "label": "06:30pm"
                },
                {
                    "value": "19:00",
                    "label": "07:00pm"
                },
                {
                    "value": "19:30",
                    "label": "07:30pm"
                },
                {
                    "value": "20:00",
                    "label": "08:00pm"
                },
                {
                    "value": "20:30",
                    "label": "08:30pm"
                },
                {
                    "value": "21:00",
                    "label": "09:00pm"
                },
                {
                    "value": "21:30",
                    "label": "09:30pm"
                },
                {
                    "value": "22:00",
                    "label": "10:00pm"
                },
                {
                    "value": "22:30",
                    "label": "10:30pm"
                },
                {
                    "value": "23:00",
                    "label": "11:00pm"
                },
                {
                    "value": "23:30",
                    "label": "11:30pm"
                }
            ],
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "00:00",
            "showClearButton": true,
            "value": "$form.time_end_maintenance$",
            "el": $('#inputEndMaintenanceTime')
        }, {
            tokens: true
        }).render();

        inputEndMaintenanceTime.on("change", function(newValue) {
            FormUtils.handleValueChange(inputEndMaintenanceTime);
        });

        //
        // KAFKA INFRASTRUCTURE
        //

        var search_kafka_infra_mainsearch = new SearchManager({
            "id": "search_kafka_infra_mainsearch",
            "latest_time": "$latest$",
            "earliest_time": "$earliest$",
            "sample_ratio": null,
            "cancelOnUnload": true,
            "search": "| inputlookup kafka_infra_inventory",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_search_env = new PostProcessManager({
            "managerid": "search_kafka_infra_mainsearch",
            "id": "search_kafka_infra_search_env",
            "search": "fillnull value=\"unknown\" env | stats count by env | fields env | dedup env | sort 0 env",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_search_label = new PostProcessManager({
            "managerid": "search_kafka_infra_mainsearch",
            "id": "search_kafka_infra_search_label",
            "search": "fillnull value=\"unknown\" label | stats count by label | fields label | dedup label | sort 0 label",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_main_table = new PostProcessManager({
            "managerid": "search_kafka_infra_mainsearch",
            "id": "search_kafka_infra_main_table",
            "search": "eval keyid = _key | fillnull value=\"unknown\" env, label | search $search_tk_kafka_infra_name$ $search_tk_kafka_infra_env$ $search_tk_kafka_infra_label$ $search_tk_kafka_infra_role$ $search_tk_kafka_infra_monitoring_state$ | fields keyid, env, label, name, role, monitoring_state, grace_period, lasttime | eval lasttime_epoch=lasttime, lasttime=strftime(lasttime_epoch, \"%d/%m/%Y %H:%M:%S\") | sort 0 role, env, label, name | eval \" \" = \"icon|\" + if(monitoring_state==\"enabled\",\"ico_good ico_small|icon-check|Up\", \"ico_error ico_small|icon-close|Down\")",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_no_components = new PostProcessManager({
            "managerid": "search_kafka_infra_mainsearch",
            "id": "search_kafka_infra_no_components",
            "search": "stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_no_components_enabled = new PostProcessManager({
            "managerid": "search_kafka_infra_mainsearch",
            "id": "search_kafka_infra_no_components_enabled",
            "search": "where monitoring_state=\"enabled\" | stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_no_components_disabled = new PostProcessManager({
            "managerid": "search_kafka_infra_mainsearch",
            "id": "search_kafka_infra_no_components_disabled",
            "search": "where monitoring_state!=\"enabled\" | stats count | rangemap field=maintenance low=0-0 high=1-1000 default=severe",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var modal_input_grace_period = new DropdownInput({
            "id": "modal_input_grace_period",
            "choices": [{
                    "value": "60",
                    "label": "1 min (60 sec)"
                },
                {
                    "value": "120",
                    "label": "2 min (120 sec)"
                },
                {
                    "value": "300",
                    "label": "5 min (300 sec)"
                },
                {
                    "value": "600",
                    "label": "10 min (600 sec)"
                },
                {
                    "value": "900",
                    "label": "15 min (900 sec)"
                }
            ],
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "300",
            "showClearButton": true,
            "value": "$form.modal_input_grace_period$",
            "el": $('#modal_input_grace_period')
        }, {
            tokens: true
        }).render();

        modal_input_grace_period.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_grace_period);
        });

        //
        // KAFKA INFRASTRUCTURE NODES
        //

        var search_kafka_infra_nodes_mainsearch = new SearchManager({
            "id": "search_kafka_infra_nodes_mainsearch",
            "latest_time": "$latest$",
            "earliest_time": "$earliest$",
            "sample_ratio": null,
            "cancelOnUnload": true,
            "search": "| inputlookup kafka_infra_nodes_inventory",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_nodes_search_env = new PostProcessManager({
            "managerid": "search_kafka_infra_nodes_mainsearch",
            "id": "search_kafka_infra_nodes_search_env",
            "search": "fillnull value=\"unknown\" env | stats count by env | fields env | dedup env | sort 0 env",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_nodes_search_label = new PostProcessManager({
            "managerid": "search_kafka_infra_nodes_mainsearch",
            "id": "search_kafka_infra_nodes_search_label",
            "search": "fillnull value=\"unknown\" label | stats count by label | fields label | dedup label | sort 0 label",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_nodes_main_table = new PostProcessManager({
            "managerid": "search_kafka_infra_nodes_mainsearch",
            "id": "search_kafka_infra_nodes_main_table",
            "search": "eval keyid = _key | fillnull value=\"unknown\" env, label | search $search_tk_kafka_infra_nodes_env$ $search_tk_kafka_infra_nodes_label$ $search_tk_kafka_infra_nodes_role$ $search_tk_kafka_infra_nodes_monitoring_state$ | fields keyid, env, label, role, current_nodes_number, minimal_nodes_number, monitoring_state | sort 0 role, env, label, role | eval \" \" = \"icon|\" + if(monitoring_state==\"enabled\",\"ico_good ico_small|icon-check|Up\", \"ico_error ico_small|icon-close|Down\")",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_nodes_no_components = new PostProcessManager({
            "managerid": "search_kafka_infra_nodes_mainsearch",
            "id": "search_kafka_infra_nodes_no_components",
            "search": "stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_nodes_no_components_enabled = new PostProcessManager({
            "managerid": "search_kafka_infra_nodes_mainsearch",
            "id": "search_kafka_infra_nodes_no_components_enabled",
            "search": "where monitoring_state=\"enabled\" | stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_infra_nodes_no_components_disabled = new PostProcessManager({
            "managerid": "search_kafka_infra_nodes_mainsearch",
            "id": "search_kafka_infra_nodes_no_components_disabled",
            "search": "where monitoring_state!=\"enabled\" | stats count | rangemap field=maintenance low=0-0 high=1-1000 default=severe",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        //
        // KAFKA TOPICS
        //

        var search_kafka_topics_mainsearch = new SearchManager({
            "id": "search_kafka_topics_mainsearch",
            "latest_time": "$latest$",
            "earliest_time": "$earliest$",
            "sample_ratio": null,
            "cancelOnUnload": true,
            "search": "| inputlookup kafka_topics_monitoring",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_topics_search_env = new PostProcessManager({
            "managerid": "search_kafka_topics_mainsearch",
            "id": "search_kafka_topics_search_env",
            "search": "fillnull value=\"unknown\" env | stats count by env | fields env | dedup env | sort 0 env",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_topics_search_label = new PostProcessManager({
            "managerid": "search_kafka_topics_mainsearch",
            "id": "search_kafka_topics_search_label",
            "search": "fillnull value=\"unknown\" label | stats count by label | fields label | dedup label | sort 0 label",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_topics_main_table = new PostProcessManager({
            "managerid": "search_kafka_topics_mainsearch",
            "id": "search_kafka_topics_main_table",
            "search": "eval keyid = _key | fillnull value=\"unknown\" env, label | search $search_tk_kafka_topics_env$ $search_tk_kafka_topics_label$ $search_tk_kafka_topics_name$ $search_tk_kafka_topics_monitoring_state$ | fields keyid, env, label, topic, monitoring_state | sort 0 env, label, name | eval \" \" = \"icon|\" + if(monitoring_state==\"enabled\",\"ico_good ico_small|icon-check|Up\", \"ico_error ico_small|icon-close|Down\")",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_topics_no_components = new PostProcessManager({
            "managerid": "search_kafka_topics_mainsearch",
            "id": "search_kafka_topics_no_components",
            "search": "stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_topics_no_components_enabled = new PostProcessManager({
            "managerid": "search_kafka_topics_mainsearch",
            "id": "search_kafka_topics_no_components_enabled",
            "search": "where monitoring_state=\"enabled\" | stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_kafka_topics_no_components_disabled = new PostProcessManager({
            "managerid": "search_kafka_topics_mainsearch",
            "id": "search_kafka_topics_no_components_disabled",
            "search": "where monitoring_state!=\"enabled\" | stats count | rangemap field=maintenance low=0-0 high=1-1000 default=severe",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        //
        // KAFKA CONNECT
        //

        var search_connect_no_connectors_mainsearch = new SearchManager({
            "id": "search_connect_no_connectors_mainsearch",
            "latest_time": "$latest$",
            "earliest_time": "$earliest$",
            "sample_ratio": null,
            "cancelOnUnload": true,
            "search": "| inputlookup kafka_connect_tasks_monitoring",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_connect_no_connectors = new PostProcessManager({
            "managerid": "search_connect_no_connectors_mainsearch",
            "id": "search_connect_no_connectors",
            "search": "stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_connect_no_connectors_enabled = new PostProcessManager({
            "managerid": "search_connect_no_connectors_mainsearch",
            "id": "search_connect_no_connectors_enabled",
            "search": "where monitoring_state=\"enabled\" | dedup env, label, connector | stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_connect_no_connectors_disabled = new PostProcessManager({
            "managerid": "search_connect_no_connectors_mainsearch",
            "id": "search_connect_no_connectors_disabled",
            "search": "where monitoring_state!=\"enabled\" | dedup env, label, connector | stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_connect_search_env = new PostProcessManager({
            "managerid": "search_connect_no_connectors_mainsearch",
            "id": "search_connect_search_env",
            "search": "fillnull value=\"unknown\" env | stats count by env | fields env | dedup env | sort 0 env",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_connect_search_label = new PostProcessManager({
            "managerid": "search_connect_no_connectors_mainsearch",
            "id": "search_connect_search_label",
            "search": "fillnull value=\"unknown\" label | stats count by label | fields label | dedup label | sort 0 label",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        // Do not use PostProcessManager here due to append which will breake in Splunk 7.0.x
        var search_connect_main_table = new SearchManager({
            "id": "search_connect_main_table",
            "sample_ratio": 1,
            "earliest_time": "-15m",
            "cancelOnUnload": true,
            "search": "| inputlookup kafka_connect_tasks_monitoring | eval keyid = _key | fillnull value=\"unknown\" env, label | append [ | mstats latest(_value) as task_state_id where `telegraf_kafka_index` metric_name=\"kafka_connect.connector-task.status\" connector=* by connector, env, label, jolokia_agent_url, task span=1s | stats min(task_state_id) as task_state_id by env, label, connector | eval task_state=case(task_state_id=0, \"paused\", task_state_id=1, \"running\", task_state_id=2, \"unassigned\", task_state_id=3, \"failed\", task_state_id=4, \"destroyed\") ] | stats values(*) as \"*\" by env, label, connector  | search $search_tk_connect_env$ $search_tk_connect_label$ $search_tk_connect_connector$ $search_tk_connect_role$ $search_tk_connect_monitoring_state$ | fields keyid, env, label, connector, role, grace_period, task_state, monitoring_state, lasttime | eval lasttime=strftime(lasttime, \"%d/%m/%Y %H:%M:%S\") | sort 0 env, label, connector | eval \" \" = \"icon|\" + if(monitoring_state==\"enabled\",\"ico_good ico_small|icon-check|Up\", \"ico_error ico_small|icon-close|Down\")",
            "latest_time": "now",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var modal_input_kafka_connector_grace_period = new DropdownInput({
            "id": "modal_input_kafka_connector_grace_period",
            "choices": [{
                    "value": "60",
                    "label": "1 min (60 sec)"
                },
                {
                    "value": "120",
                    "label": "2 min (120 sec)"
                },
                {
                    "value": "300",
                    "label": "5 min (300 sec)"
                },
                {
                    "value": "600",
                    "label": "10 min (600 sec)"
                },
                {
                    "value": "900",
                    "label": "15 min (900 sec)"
                }
            ],
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "initialValue": "300",
            "showClearButton": true,
            "value": "$form.modal_input_kafka_connector_grace_period$",
            "el": $('#modal_input_kafka_connector_grace_period')
        }, {
            tokens: true
        }).render();

        modal_input_kafka_connector_grace_period.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_kafka_connector_grace_period);
        });

        //
        // KAFKA BURROW
        //

        var search_burrow_mainsearch = new SearchManager({
            "id": "search_burrow_mainsearch",
            "latest_time": "$latest$",
            "earliest_time": "$earliest$",
            "sample_ratio": null,
            "cancelOnUnload": true,
            "search": "| inputlookup kafka_burrow_consumers_monitoring",
            "status_buckets": 0,
            "app": utils.getCurrentApp(),
            "auto_cancel": 90,
            "preview": true,
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_burrow_no_consumers = new PostProcessManager({
            "managerid": "search_burrow_mainsearch",
            "id": "search_burrow_no_consumers",
            "search": "stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_burrow_no_consumers_enabled = new PostProcessManager({
            "managerid": "search_burrow_mainsearch",
            "id": "search_burrow_no_consumers_enabled",
            "search": "where monitoring_state=\"enabled\" | stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_burrow_no_consumers_disabled = new PostProcessManager({
            "managerid": "search_burrow_mainsearch",
            "id": "search_burrow_no_consumers_disabled",
            "search": "where monitoring_state!=\"enabled\" | stats count",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_burrow_search_env = new PostProcessManager({
            "managerid": "search_burrow_mainsearch",
            "id": "search_burrow_search_env",
            "search": "fillnull value=\"unknown\" env | stats count by env | fields env | dedup env | sort 0 env",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_burrow_search_label = new PostProcessManager({
            "managerid": "search_burrow_mainsearch",
            "id": "search_burrow_search_label",
            "search": "fillnull value=\"unknown\" label | stats count by label | fields label | dedup label | sort 0 label",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_burrow_search_cluster = new PostProcessManager({
            "managerid": "search_burrow_mainsearch",
            "id": "search_burrow_search_cluster",
            "search": "stats count by cluster | fields cluster | dedup cluster | sort 0 cluster",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        var search_burrow_main_table = new PostProcessManager({
            "managerid": "search_burrow_mainsearch",
            "id": "search_burrow_main_table",
            "search": "eval keyid = _key | fillnull value=\"unknown\" env, label | search $search_tk_burrow_env$ $search_tk_burrow_label$ $search_tk_burrow_cluster$ $search_tk_burrow_monitoring_state$ $search_tk_burrow_name$ | fields keyid, env, label, cluster, group, monitoring_state | sort 0 env, label, cluster, group | eval \" \" = \"icon|\" + if(monitoring_state==\"enabled\",\"ico_good ico_small|icon-check|Up\", \"ico_error ico_small|icon-close|Down\")",
            "tokenDependencies": {},
            "runWhenTimeIsUndefined": false
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        });

        //
        // SPLUNK LAYOUT
        //

        $('header').remove();
        new LayoutView({
                "hideAppBar": false,
                "hideChrome": false,
                "hideSplunkBar": false
            })
            .render()
            .getContainerElement()
            .appendChild($('.dashboard-body')[0]);

        //
        // DASHBOARD EDITOR
        //

        new Dashboard({
            id: 'dashboard',
            el: $('.dashboard-body'),
            showTitle: true,
            editable: false
        }, {
            tokens: true
        }).render();


        //
        // VIEWS: VISUALIZATION ELEMENTS
        //

        //
        // ALERT SUMMARY
        //

        var element_kafka_alerts_main_table = new TableElement({
            "id": "element_kafka_alerts_main_table",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "row",
            "fields": "title, cron_schedule, schedule_window, alert.suppress.fields, alert.suppress.period, disabled, next_scheduled_time, \" \"",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "search_kafka_alerts_main_table",
            "el": $('#element_kafka_alerts_main_table')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        element_kafka_alerts_main_table.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();

                setToken("tk_kafka_alert_title", TokenUtils.replaceTokenNames("$row.title$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_alert_cron_schedule", TokenUtils.replaceTokenNames("$row.cron_schedule$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_alert_schedule_window", TokenUtils.replaceTokenNames("$row.schedule_window$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_alert_suppress_fields", TokenUtils.replaceTokenNames("$row.alert.suppress.fields$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_alert_suppress_period", TokenUtils.replaceTokenNames("$row.alert.suppress.period$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_alert_disabled", TokenUtils.replaceTokenNames("$row.disabled$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_alert_next_scheduled_time", TokenUtils.replaceTokenNames("$row.next_scheduled_time$", _.extend(submittedTokenModel.toJSON(), e.data)));

                // Define the alert URL
                var url = TokenUtils.replaceTokenNames("{{SPLUNKWEB_URL_PREFIX}}/app/telegraf-kafka/alert?s=%2FservicesNS%2Fnobody%2Ftelegraf-kafka%2Fsaved%2Fsearches%2F$row.id$", _.extend(submittedTokenModel.toJSON(), e.data), TokenUtils.getEscaper('url'), TokenUtils.getFilters(mvc.Components));
                var alert_url = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + url;
                //console.log("full url is " + alert_url);

                // Define the URL target
                document.getElementById("btn_url_modal_manage_kafka_alert").href = alert_url;

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                // Retrieve alert title token
                var tk_kafka_alert_title = tokens.get("tk_kafka_alert_title");

                // Define the history search
                var alert_search_history = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '') + '//app/telegraf-kafka/search' + "?q=search%20index%3D_audit%20action%3D\"alert_fired\"%20ss_app%3D\"telegraf-kafka\"%20ss_name%3D\"" + encodeURI(tk_kafka_alert_title) + "\""

                // Define the URL target
                document.getElementById("btn_url_modal_history_kafka_alert").href = alert_search_history;

                // Enable modal context
                $("#modal_manage_kafka_alerts").modal();

            }
        });

        var body_modal_manage_kafka_alerts = new HtmlElement({
            "id": "body_modal_manage_kafka_alerts",
            "useTokens": true,
            "el": $('#body_modal_manage_kafka_alerts')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_kafka_alerts.contentLoaded());

        //
        // MAINTENANCE MODE
        //

        var element_maintenance_state = new SingleElement({
            "id": "element_maintenance_state",
            "drilldown": "none",
            "colorMode": "block",
            "link.visible": "false",
            "numberPrecision": "0",
            "useColors": "0",
            "underLabel": "MAINTENANCE MODE STATUS",
            "colorBy": "value",
            "height": "60",
            "managerid": "search_maintenance_state",
            "el": $('#element_maintenance_state')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_maintenance_state_reactivation = new SingleElement({
            "id": "element_maintenance_state_reactivation",
            "drilldown": "none",
            "colorMode": "block",
            "link.visible": "false",
            "numberPrecision": "0",
            "useColors": "0",
            "underLabel": "ESTIMATED DATE FOR AUTO-DEACTIVATION OF THE MAINTENANCE MODE",
            "colorBy": "value",
            "height": "60",
            "managerid": "search_maintenance_state_reactivation",
            "el": $('#element_maintenance_state_reactivation')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_maintenance_state_scheduled = new SingleElement({
            "id": "element_maintenance_state_scheduled",
            "drilldown": "none",
            "colorMode": "block",
            "link.visible": "false",
            "numberPrecision": "0",
            "useColors": "0",
            "underLabel": "MAINTENANCE MODE HAS BEEN SCHEDULED",
            "colorBy": "value",
            "height": "60",
            "managerid": "search_maintenance_state_scheduled",
            "el": $('#element_maintenance_state_scheduled')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        //
        // KAFKA INFRA
        //

        var element_kafka_infra_single1 = new SingleElement({
            "id": "element_kafka_infra_single1",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL COMPONENTS DISCOVERED",
            "drilldown": "none",
            "managerid": "search_kafka_infra_no_components",
            "el": $('#element_kafka_infra_single1')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_infra_single2 = new SingleElement({
            "id": "element_kafka_infra_single2",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL COMPONENTS MONITORED",
            "drilldown": "none",
            "managerid": "search_kafka_infra_no_components_enabled",
            "el": $('#element_kafka_infra_single2')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_infra_single3 = new SingleElement({
            "id": "element_kafka_infra_single3",
            "underLabel": "NOT MONITORED COMPONENTS",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x53a051\",\"0xf1813f\"]",
            "colorMode": "none",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "showTrendIndicator": "1",
            "trendDisplayMode": "absolute",
            "trellis.size": "medium",
            "drilldown": "none",
            "numberPrecision": "0",
            "trendColorInterpretation": "standard",
            "useColors": "1",
            "colorBy": "value",
            "unitPosition": "after",
            "managerid": "search_kafka_infra_no_components_disabled",
            "el": $('#element_kafka_infra_single3')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_infra_main_table = new TableElement({
            "id": "element_kafka_infra_main_table",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "row",
            "fields": "keyid, env, label, name, role, monitoring_state, \" \", grace_period, lasttime",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "search_kafka_infra_main_table",
            "el": $('#element_kafka_infra_main_table')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        element_kafka_infra_main_table.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("form.tk_kafka_infra_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_name", TokenUtils.replaceTokenNames("$row.name$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_role", TokenUtils.replaceTokenNames("$row.role$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_env", TokenUtils.replaceTokenNames("$row.env$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_label", TokenUtils.replaceTokenNames("$row.label$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.modal_input_grace_period", TokenUtils.replaceTokenNames("$row.grace_period$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_grace_period", TokenUtils.replaceTokenNames("$row.grace_period$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_monitoring_state", TokenUtils.replaceTokenNames("$row.monitoring_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_lasttime", TokenUtils.replaceTokenNames("$row.lasttime_epoch$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_kafka_infra_monitoring_state = tokens.get("tk_kafka_infra_monitoring_state");

                // Dynamically manage buttons states
                if (tk_kafka_infra_monitoring_state == "enabled") {
                    document.getElementById('btn_enable_modal_manage_kafka_infra1').disabled = true;
                    document.getElementById('btn_disable_modal_manage_kafka_infra1').disabled = false;
                } else {
                    document.getElementById('btn_enable_modal_manage_kafka_infra1').disabled = false;
                    document.getElementById('btn_disable_modal_manage_kafka_infra1').disabled = true;
                }

                // Enable modal context
                $("#modal_manage_kafka_infra1").modal();
            }
        });

        var body_modal_manage_kafka_infra1 = new HtmlElement({
            "id": "body_modal_manage_kafka_infra1",
            "useTokens": true,
            "el": $('#body_modal_manage_kafka_infra1')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_kafka_infra1.contentLoaded());

        //
        // KAFKA INFRA NODES
        //

        var element_kafka_infra_nodes_single1 = new SingleElement({
            "id": "element_kafka_infra_nodes_single1",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL COMPONENT ROLES DISCOVERED",
            "drilldown": "none",
            "managerid": "search_kafka_infra_nodes_no_components",
            "el": $('#element_kafka_infra_nodes_single1')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_infra_nodes_single2 = new SingleElement({
            "id": "element_kafka_infra_nodes_single2",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL COMPONENT ROLES MONITORED",
            "drilldown": "none",
            "managerid": "search_kafka_infra_nodes_no_components_enabled",
            "el": $('#element_kafka_infra_nodes_single2')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_infra_nodes_single3 = new SingleElement({
            "id": "element_kafka_infra_nodes_single3",
            "underLabel": "NOT MONITORED COMPONENT ROLES",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x53a051\",\"0xf1813f\"]",
            "colorMode": "none",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "showTrendIndicator": "1",
            "trendDisplayMode": "absolute",
            "trellis.size": "medium",
            "drilldown": "none",
            "numberPrecision": "0",
            "trendColorInterpretation": "standard",
            "useColors": "1",
            "colorBy": "value",
            "unitPosition": "after",
            "managerid": "search_kafka_infra_nodes_no_components_disabled",
            "el": $('#element_kafka_infra_nodes_single3')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_infra_nodes_main_table = new TableElement({
            "id": "element_kafka_infra_nodes_main_table",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "row",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "search_kafka_infra_nodes_main_table",
            "el": $('#element_kafka_infra_nodes_main_table')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        element_kafka_infra_nodes_main_table.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("tk_kafka_infra_nodes_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_nodes_role", TokenUtils.replaceTokenNames("$row.role$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_nodes_env", TokenUtils.replaceTokenNames("$row.env$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_nodes_label", TokenUtils.replaceTokenNames("$row.label$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_nodes_current_nodes_number", TokenUtils.replaceTokenNames("$row.current_nodes_number$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_nodes_minimal_nodes_number", TokenUtils.replaceTokenNames("$row.minimal_nodes_number$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_infra_nodes_monitoring_state", TokenUtils.replaceTokenNames("$row.monitoring_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_kafka_infra_nodes_monitoring_state = tokens.get("tk_kafka_infra_nodes_monitoring_state");

                // Dynamically manage buttons states
                if (tk_kafka_infra_nodes_monitoring_state == "enabled") {
                    document.getElementById('btn_enable_modal_manage_kafka_infra_nodes').disabled = true;
                    document.getElementById('btn_disable_modal_manage_kafka_infra_nodes').disabled = false;
                } else {
                    document.getElementById('btn_enable_modal_manage_kafka_infra_nodes').disabled = false;
                    document.getElementById('btn_disable_modal_manage_kafka_infra_nodes').disabled = true;
                }

                // Enable modal context
                $("#modal_manage_kafka_infra_nodes").modal();

            }
        });

        var body_modal_manage_kafka_infra_nodes = new HtmlElement({
            "id": "body_modal_manage_kafka_infra_nodes",
            "useTokens": true,
            "el": $('#body_modal_manage_kafka_infra_nodes')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_kafka_infra_nodes.contentLoaded());

        //
        // KAFKA TOPICS
        //

        var element_kafka_topics_single1 = new SingleElement({
            "id": "element_kafka_topics_single1",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL TOPICS DISCOVERED",
            "drilldown": "none",
            "managerid": "search_kafka_topics_no_components",
            "el": $('#element_kafka_topics_single1')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_topics_single2 = new SingleElement({
            "id": "element_kafka_topics_single2",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL TOPICS MONITORED",
            "drilldown": "none",
            "managerid": "search_kafka_topics_no_components_enabled",
            "el": $('#element_kafka_topics_single2')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_topics_single3 = new SingleElement({
            "id": "element_kafka_topics_single3",
            "underLabel": "NOT MONITORED TOPICS",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x53a051\",\"0xf1813f\"]",
            "colorMode": "none",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "showTrendIndicator": "1",
            "trendDisplayMode": "absolute",
            "trellis.size": "medium",
            "drilldown": "none",
            "numberPrecision": "0",
            "trendColorInterpretation": "standard",
            "useColors": "1",
            "colorBy": "value",
            "unitPosition": "after",
            "managerid": "search_kafka_topics_no_components_disabled",
            "el": $('#element_kafka_topics_single3')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_kafka_topics_main_table = new TableElement({
            "id": "element_kafka_topics_main_table",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "row",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "search_kafka_topics_main_table",
            "el": $('#element_kafka_topics_main_table')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        element_kafka_topics_main_table.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("tk_kafka_topic_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_topic_name", TokenUtils.replaceTokenNames("$row.topic$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_topic_env", TokenUtils.replaceTokenNames("$row.env$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_topic_label", TokenUtils.replaceTokenNames("$row.label$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_topic_monitoring_state", TokenUtils.replaceTokenNames("$row.monitoring_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_kafka_topic_monitoring_state = tokens.get("tk_kafka_topic_monitoring_state");

                // Dynamically manage buttons states
                if (tk_kafka_topic_monitoring_state == "enabled") {
                    document.getElementById('btn_enable_modal_manage_kafka_topic').disabled = true;
                    document.getElementById('btn_disable_modal_manage_kafka_topic').disabled = false;
                } else {
                    document.getElementById('btn_enable_modal_manage_kafka_topic').disabled = false;
                    document.getElementById('btn_disable_modal_manage_kafka_topic').disabled = true;
                }

                // Enable modal context
                $("#modal_manage_kafka_topics").modal();

            }
        });

        var body_modal_manage_kafka_topics = new HtmlElement({
            "id": "body_modal_manage_kafka_topics",
            "useTokens": true,
            "el": $('#body_modal_manage_kafka_topics')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_kafka_topics.contentLoaded());

        //
        // KAFKA CONNECT
        //

        var element_connect_single1 = new SingleElement({
            "id": "element_connect_single1",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL CONNECTORS DISCOVERED",
            "drilldown": "none",
            "managerid": "search_connect_no_connectors",
            "el": $('#element_connect_single1')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_connect_single2 = new SingleElement({
            "id": "element_connect_single2",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL CONNECTORS MONITORED",
            "drilldown": "none",
            "managerid": "search_connect_no_connectors_enabled",
            "el": $('#element_connect_single2')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_connect_single3 = new SingleElement({
            "id": "element_connect_single3",
            "underLabel": "NOT MONITORED CONNECTORS",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x53a051\",\"0xf1813f\"]",
            "colorMode": "none",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "showTrendIndicator": "1",
            "trendDisplayMode": "absolute",
            "trellis.size": "medium",
            "drilldown": "none",
            "numberPrecision": "0",
            "trendColorInterpretation": "standard",
            "useColors": "1",
            "colorBy": "value",
            "unitPosition": "after",
            "managerid": "search_connect_no_connectors_disabled",
            "el": $('#element_connect_single3')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_connect_main_table = new TableElement({
            "id": "element_connect_main_table",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "row",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "search_connect_main_table",
            "el": $('#element_connect_main_table')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        element_connect_main_table.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("tk_kafka_connector_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_connector_name", TokenUtils.replaceTokenNames("$row.connector$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_connector_role", TokenUtils.replaceTokenNames("$row.role$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_connector_env", TokenUtils.replaceTokenNames("$row.env$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_connector_label", TokenUtils.replaceTokenNames("$row.label$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_connector_grace_period", TokenUtils.replaceTokenNames("$row.grace_period$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_kafka_connector_monitoring_state", TokenUtils.replaceTokenNames("$row.monitoring_state$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("form.modal_input_kafka_connector_grace_period", TokenUtils.replaceTokenNames("$row.grace_period$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_kafka_connector_monitoring_state = tokens.get("tk_kafka_connector_monitoring_state");

                // Dynamically manage buttons states
                if (tk_kafka_connector_monitoring_state == "enabled") {
                    document.getElementById('btn_enable_modal_manage_kafka_connector').disabled = true;
                    document.getElementById('btn_disable_modal_manage_kafka_connector').disabled = false;
                } else {
                    document.getElementById('btn_enable_modal_manage_kafka_connector').disabled = false;
                    document.getElementById('btn_disable_modal_manage_kafka_connector').disabled = true;
                }

                // Enable modal context
                $("#modal_manage_kafka_connector").modal();

            }
        });

        var body_modal_manage_kafka_connector = new HtmlElement({
            "id": "body_modal_manage_kafka_connector",
            "useTokens": true,
            "el": $('#body_modal_manage_kafka_connector')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_kafka_connector.contentLoaded());

        //
        // KAFKA BURROW
        //

        var element_burrow_single1 = new SingleElement({
            "id": "element_burrow_single1",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL CONSUMERS DISCOVERED",
            "drilldown": "none",
            "managerid": "search_burrow_no_consumers",
            "el": $('#element_burrow_single1')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_burrow_single2 = new SingleElement({
            "id": "element_burrow_single2",
            "rangeColors": "[\"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0xdc4e41\"]",
            "underLabel": "TOTAL CONSUMERS MONITORED",
            "drilldown": "none",
            "managerid": "search_burrow_no_consumers_enabled",
            "el": $('#element_burrow_single2')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_burrow_single3 = new SingleElement({
            "id": "element_burrow_single3",
            "underLabel": "NOT MONITORED CONSUMERS",
            "showSparkline": "1",
            "trellis.enabled": "0",
            "rangeValues": "[0]",
            "rangeColors": "[\"0x53a051\",\"0xf1813f\"]",
            "colorMode": "none",
            "trellis.scales.shared": "1",
            "useThousandSeparators": "1",
            "showTrendIndicator": "1",
            "trendDisplayMode": "absolute",
            "trellis.size": "medium",
            "drilldown": "none",
            "numberPrecision": "0",
            "trendColorInterpretation": "standard",
            "useColors": "1",
            "colorBy": "value",
            "unitPosition": "after",
            "managerid": "search_burrow_no_consumers_disabled",
            "el": $('#element_burrow_single3')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        var element_burrow_main_table = new TableElement({
            "id": "element_burrow_main_table",
            "count": 100,
            "dataOverlayMode": "none",
            "drilldown": "row",
            "percentagesRow": "false",
            "rowNumbers": "false",
            "totalsRow": "false",
            "wrap": "true",
            "managerid": "search_burrow_main_table",
            "el": $('#element_burrow_main_table')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        element_burrow_main_table.on("click", function(e) {
            if (e.field !== undefined) {
                e.preventDefault();
                setToken("tk_burrow_keyid", TokenUtils.replaceTokenNames("$row.keyid$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_burrow_env", TokenUtils.replaceTokenNames("$row.env$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_burrow_label", TokenUtils.replaceTokenNames("$row.label$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_burrow_cluster", TokenUtils.replaceTokenNames("$row.cluster$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_burrow_group", TokenUtils.replaceTokenNames("$row.group$", _.extend(submittedTokenModel.toJSON(), e.data)));
                setToken("tk_burrow_monitoring_state", TokenUtils.replaceTokenNames("$row.monitoring_state$", _.extend(submittedTokenModel.toJSON(), e.data)));

                submitTokens();

                // When the Submit button is clicked, get all the form fields by accessing token values
                var tokens = mvc.Components.get("default");

                var tk_burrow_monitoring_state = tokens.get("tk_burrow_monitoring_state");

                // Dynamically manage buttons states
                if (tk_burrow_monitoring_state == "enabled") {
                    document.getElementById('btn_enable_modal_manage_kafka_consumer').disabled = true;
                    document.getElementById('btn_disable_modal_manage_kafka_consumer').disabled = false;
                } else {
                    document.getElementById('btn_enable_modal_manage_kafka_consumer').disabled = false;
                    document.getElementById('btn_disable_modal_manage_kafka_consumer').disabled = true;
                }

                // Enable modal context
                $("#modal_manage_kafka_consumers").modal();
            }
        });

        var body_modal_manage_kafka_consumers = new HtmlElement({
            "id": "body_modal_manage_kafka_consumers",
            "useTokens": true,
            "el": $('#body_modal_manage_kafka_consumers')
        }, {
            tokens: true,
            tokenNamespace: "submitted"
        }).render();

        DashboardController.addReadyDep(body_modal_manage_kafka_consumers.contentLoaded());

        //
        //
        //

        // Initialize time tokens to default
        if (!defaultTokenModel.has('earliest') && !defaultTokenModel.has('latest')) {
            defaultTokenModel.set({
                earliest: '0',
                latest: ''
            });
        }

        submitTokens();

        //
        // VIEWS: FORM INPUTS
        //

        //
        // link-input
        //

        var inputlink1 = new LinkListInput({
            "id": "inputlink1",
            "choices": [{
                    "value": "selection1",
                    "label": "ALERT CONFIGURATION SUMMARY"
                },
                {
                    "value": "selection2",
                    "label": "STALE METRICS MONITORING PER COMPONENT"
                },
                {
                    "value": "selection3",
                    "label": "STALE METRICS MONITORING PER NUMBER OF NODES"
                },
                {
                    "value": "selection4",
                    "label": "KAFKA TOPICS MONITORING"
                },
                {
                    "value": "selection5",
                    "label": "KAFKA CONNECT TASKS MONITORING"
                },
                {
                    "value": "selection6",
                    "label": "KAFKA CONSUMER GROUP MONITORING"
                }
            ],
            "default": "selection1",
            "searchWhenChanged": true,
            "selectFirstChoice": false,
            "value": "$form.tabs_linkinput$",
            "el": $('#inputlink1')
        }, {
            tokens: true
        }).render();

        inputlink1.on("change", function(newValue) {
            FormUtils.handleValueChange(inputlink1);
        });

        inputlink1.on("valueChange", function(e) {
            if (e.value === "selection1") {
                EventHandler.setToken("selection1", "true", {}, e.data);
                EventHandler.unsetToken("selection2");
                EventHandler.unsetToken("selection3");
                EventHandler.unsetToken("selection4");
                EventHandler.unsetToken("selection5");
                EventHandler.unsetToken("selection6");
            } else if (e.value === "selection2") {
                EventHandler.setToken("selection2", "true", {}, e.data);
                EventHandler.unsetToken("selection1");
                EventHandler.unsetToken("selection3");
                EventHandler.unsetToken("selection4");
                EventHandler.unsetToken("selection5");
                EventHandler.unsetToken("selection6");
            } else if (e.value === "selection2") {
                EventHandler.setToken("selection2", "true", {}, e.data);
                EventHandler.unsetToken("selection1");
                EventHandler.unsetToken("selection3");
                EventHandler.unsetToken("selection4");
                EventHandler.unsetToken("selection5");
                EventHandler.unsetToken("selection6");
            } else if (e.value === "selection3") {
                EventHandler.setToken("selection3", "true", {}, e.data);
                EventHandler.unsetToken("selection1");
                EventHandler.unsetToken("selection2");
                EventHandler.unsetToken("selection4");
                EventHandler.unsetToken("selection5");
                EventHandler.unsetToken("selection6");
            } else if (e.value === "selection4") {
                EventHandler.setToken("selection4", "true", {}, e.data);
                EventHandler.unsetToken("selection1");
                EventHandler.unsetToken("selection2");
                EventHandler.unsetToken("selection3");
                EventHandler.unsetToken("selection5");
                EventHandler.unsetToken("selection6");
            } else if (e.value === "selection5") {
                EventHandler.setToken("selection5", "true", {}, e.data);
                EventHandler.unsetToken("selection1");
                EventHandler.unsetToken("selection2");
                EventHandler.unsetToken("selection3");
                EventHandler.unsetToken("selection4");
                EventHandler.unsetToken("selection6");
            } else if (e.value === "selection6") {
                EventHandler.setToken("selection6", "true", {}, e.data);
                EventHandler.unsetToken("selection1");
                EventHandler.unsetToken("selection2");
                EventHandler.unsetToken("selection3");
                EventHandler.unsetToken("selection4");
                EventHandler.unsetToken("selection5");
            }
        });

        //
        // KAFKA INFRA
        //

        var input_kafka_infra_search_name = new TextInput({
            "id": "input_kafka_infra_search_name",
            "searchWhenChanged": true,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "name=\"",
            "value": "$form.search_tk_kafka_infra_name$",
            "el": $('#input_kafka_infra_search_name')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_search_name.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_search_name);
        });

        var input_kafka_infra_search_env = new DropdownInput({
            "id": "input_kafka_infra_search_env",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "env",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "env=\"",
            "valueField": "env",
            "value": "$form.search_tk_kafka_infra_env$",
            "managerid": "search_kafka_infra_search_env",
            "el": $('#input_kafka_infra_search_env')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_search_env.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_search_env);
        });

        var input_kafka_infra_search_label = new DropdownInput({
            "id": "input_kafka_infra_search_label",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "label",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "label=\"",
            "valueField": "label",
            "value": "$form.search_tk_kafka_infra_label$",
            "managerid": "search_kafka_infra_search_label",
            "el": $('#input_kafka_infra_search_label')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_search_label.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_search_label);
        });

        var input_kafka_infra_search_role = new DropdownInput({
            "id": "input_kafka_infra_search_role",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                },
                {
                    "label": "zookeeper",
                    "value": "zookeeper"
                },
                {
                    "label": "kafka_broker",
                    "value": "kafka_broker"
                },
                {
                    "label": "kafka_connect",
                    "value": "kafka_connect"
                },
                {
                    "label": "schema-registry",
                    "value": "schema-registry"
                },
                {
                    "label": "ksql-server",
                    "value": "ksql-server"
                },
                {
                    "label": "kafka_rest",
                    "value": "kafka_rest"
                },
                {
                    "label": "kafka_linkedin_monitor",
                    "value": "kafka_linkedin_monitor"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "role=\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "suffix": "\"",
            "showClearButton": true,
            "value": "$form.search_tk_kafka_infra_role$",
            "el": $('#input_kafka_infra_search_role')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_search_role.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_search_role);
        });

        var input_kafka_infra_search_monitoring_state = new DropdownInput({
            "id": "input_kafka_infra_search_monitoring_state",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                },
                {
                    "label": "enabled",
                    "value": "enabled"
                },
                {
                    "label": "disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "monitoring_state=\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "suffix": "\"",
            "showClearButton": true,
            "value": "$form.search_tk_kafka_infra_monitoring_state$",
            "el": $('#input_kafka_infra_search_monitoring_state')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_search_monitoring_state.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_search_monitoring_state);
        });

        var input_kafka_infra_modify_grace_period = new TextInput({
            "id": "input_kafka_infra_modify_grace_period",
            "searchWhenChanged": true,
            "value": "$tk_kafka_grace_period$",
            "el": $('#input_kafka_infra_modify_grace_period')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_modify_grace_period.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_modify_grace_period);
        });

        var input_kafka_infra_modify_monitoring_state = new DropdownInput({
            "id": "input_kafka_infra_modify_monitoring_state",
            "choices": [{
                    "label": "enabled",
                    "value": "enabled"
                },
                {
                    "label": "disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "showClearButton": false,
            "value": "$tk_kafka_monitoring_state$",
            "el": $('#input_kafka_infra_modify_monitoring_state')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_modify_monitoring_state.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_modify_monitoring_state);
        });

        var input_kafka_infra_delete = new TextInput({
            "id": "input_kafka_infra_delete",
            "searchWhenChanged": true,
            "value": "$form.tk_kafka_infra_keyid$",
            "el": $('#input_kafka_infra_delete')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_delete.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_delete);
        });

        //
        // KAFKA INFRA NODES
        //

        var input_kafka_infra_nodes_search_env = new DropdownInput({
            "id": "input_kafka_infra_nodes_search_env",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "env",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "env=\"",
            "valueField": "env",
            "value": "$form.search_tk_kafka_infra_nodes_env$",
            "managerid": "search_kafka_infra_nodes_search_env",
            "el": $('#input_kafka_infra_nodes_search_env')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_nodes_search_env.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_nodes_search_env);
        });

        var input_kafka_infra_nodes_search_label = new DropdownInput({
            "id": "input_kafka_infra_nodes_search_label",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "label",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "label=\"",
            "valueField": "label",
            "value": "$form.search_tk_kafka_infra_nodes_label$",
            "managerid": "search_kafka_infra_nodes_search_label",
            "el": $('#input_kafka_infra_nodes_search_label')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_nodes_search_label.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_nodes_search_label);
        });

        var input_kafka_infra_nodes_search_role = new DropdownInput({
            "id": "input_kafka_infra_nodes_search_role",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                },
                {
                    "label": "zookeeper",
                    "value": "zookeeper"
                },
                {
                    "label": "kafka_broker",
                    "value": "kafka_broker"
                },
                {
                    "label": "kafka_connect",
                    "value": "kafka_connect"
                },
                {
                    "label": "schema-registry",
                    "value": "schema-registry"
                },
                {
                    "label": "ksql-server",
                    "value": "ksql-server"
                },
                {
                    "label": "kafka_rest",
                    "value": "kafka_rest"
                },
                {
                    "label": "kafka_linkedin_monitor",
                    "value": "kafka_linkedin_monitor"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "role=\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "suffix": "\"",
            "showClearButton": true,
            "value": "$form.search_tk_kafka_infra_nodes_role$",
            "el": $('#input_kafka_infra_nodes_search_role')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_nodes_search_role.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_nodes_search_role);
        });

        var input_kafka_infra_nodes_search_monitoring_state = new DropdownInput({
            "id": "input_kafka_infra_nodes_search_monitoring_state",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                },
                {
                    "label": "enabled",
                    "value": "enabled"
                },
                {
                    "label": "disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "monitoring_state=\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "suffix": "\"",
            "showClearButton": true,
            "value": "$form.search_tk_kafka_infra_nodes_monitoring_state$",
            "el": $('#input_kafka_infra_nodes_search_monitoring_state')
        }, {
            tokens: true
        }).render();

        input_kafka_infra_nodes_search_monitoring_state.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_infra_nodes_search_monitoring_state);
        });

        var modal_input_minimal_nodes_number = new TextInput({
            "id": "modal_input_minimal_nodes_number",
            "searchWhenChanged": true,
            "value": "$form.tk_input_infra_nodes_number$",
            "el": $('#modal_input_minimal_nodes_number')
        }, {
            tokens: true
        }).render();

        modal_input_minimal_nodes_number.on("change", function(newValue) {
            FormUtils.handleValueChange(modal_input_minimal_nodes_number);
        });

        //
        // KAFKA TOPICS
        //

        var input_kafka_topics_search_name = new TextInput({
            "id": "input_kafka_topics_search_name",
            "searchWhenChanged": true,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "topic=\"",
            "value": "$form.search_tk_kafka_topics_name$",
            "el": $('#input_kafka_topics_search_name')
        }, {
            tokens: true
        }).render();

        input_kafka_topics_search_name.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_topics_search_name);
        });

        var input_kafka_topics_search_env = new DropdownInput({
            "id": "input_kafka_topics_search_env",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "env",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "env=\"",
            "valueField": "env",
            "value": "$form.search_tk_kafka_topics_env$",
            "managerid": "search_kafka_topics_search_env",
            "el": $('#input_kafka_topics_search_env')
        }, {
            tokens: true
        }).render();

        input_kafka_topics_search_env.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_topics_search_env);
        });

        var input_kafka_topics_search_label = new DropdownInput({
            "id": "input_kafka_topics_search_label",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "label",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "label=\"",
            "valueField": "label",
            "value": "$form.search_tk_kafka_topics_label$",
            "managerid": "search_kafka_topics_search_label",
            "el": $('#input_kafka_topics_search_label')
        }, {
            tokens: true
        }).render();

        input_kafka_topics_search_label.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_topics_search_label);
        });

        var input_kafka_topics_search_monitoring_state = new DropdownInput({
            "id": "input_kafka_topics_search_monitoring_state",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                },
                {
                    "label": "enabled",
                    "value": "enabled"
                },
                {
                    "label": "disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "monitoring_state=\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "suffix": "\"",
            "showClearButton": true,
            "value": "$form.search_tk_kafka_topics_monitoring_state$",
            "el": $('#input_kafka_topics_search_monitoring_state')
        }, {
            tokens: true
        }).render();

        input_kafka_topics_search_monitoring_state.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_topics_search_monitoring_state);
        });

        var input_kafka_topics_modify_monitoring_state = new DropdownInput({
            "id": "input_kafka_topics_modify_monitoring_state",
            "choices": [{
                    "label": "enabled",
                    "value": "enabled"
                },
                {
                    "label": "disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "enabled",
            "initialValue": "enabled",
            "selectFirstChoice": false,
            "showClearButton": false,
            "value": "$form.modify_tk_kafka_topics_monitoring_state$",
            "el": $('#input_kafka_topics_modify_monitoring_state')
        }, {
            tokens: true
        }).render();

        input_kafka_topics_modify_monitoring_state.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_topics_modify_monitoring_state);
        });

        var input_kafka_topics_delete = new TextInput({
            "id": "input_kafka_topics_delete",
            "searchWhenChanged": true,
            "value": "$form.tk_kafka_topics_keyid$",
            "el": $('#input_kafka_topics_delete')
        }, {
            tokens: true
        }).render();

        input_kafka_topics_delete.on("change", function(newValue) {
            FormUtils.handleValueChange(input_kafka_topics_delete);
        });

        //
        // KAFKA CONNECT
        //

        var input_connect_search_connector = new TextInput({
            "id": "input_connect_search_connector",
            "searchWhenChanged": true,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "connector=\"",
            "value": "$form.search_tk_connect_connector$",
            "el": $('#input_connect_search_connector')
        }, {
            tokens: true
        }).render();

        input_connect_search_connector.on("change", function(newValue) {
            FormUtils.handleValueChange(input_connect_search_connector);
        });

        var input_connect_search_env = new DropdownInput({
            "id": "input_connect_search_env",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "env",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "env=\"",
            "valueField": "env",
            "value": "$form.search_tk_connect_env$",
            "managerid": "search_connect_search_env",
            "el": $('#input_connect_search_env')
        }, {
            tokens: true
        }).render();

        input_connect_search_env.on("change", function(newValue) {
            FormUtils.handleValueChange(input_connect_search_env);
        });

        var input_connect_search_label = new DropdownInput({
            "id": "input_connect_search_label",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "label",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "label=\"",
            "valueField": "label",
            "value": "$form.search_tk_connect_label$",
            "managerid": "search_connect_search_label",
            "el": $('#input_connect_search_label')
        }, {
            tokens: true
        }).render();

        input_connect_search_label.on("change", function(newValue) {
            FormUtils.handleValueChange(input_connect_search_label);
        });

        var input_connect_search_task = new DropdownInput({
            "id": "input_connect_search_task",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                },
                {
                    "label": "kafka_source_task",
                    "value": "kafka_source_task"
                },
                {
                    "label": "kafka_sink_task",
                    "value": "kafka_sink_task"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "role=\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "suffix": "\"",
            "showClearButton": true,
            "value": "$form.search_tk_connect_role$",
            "el": $('#input_connect_search_task')
        }, {
            tokens: true
        }).render();

        input_connect_search_task.on("change", function(newValue) {
            FormUtils.handleValueChange(input_connect_search_task);
        });

        var input_connect_search_monitoring_state = new DropdownInput({
            "id": "input_connect_search_monitoring_state",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                },
                {
                    "label": "enabled",
                    "value": "enabled"
                },
                {
                    "label": "disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "monitoring_state=\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "suffix": "\"",
            "showClearButton": true,
            "value": "$form.search_tk_connect_monitoring_state$",
            "el": $('#input_connect_search_monitoring_state')
        }, {
            tokens: true
        }).render();

        input_connect_search_monitoring_state.on("change", function(newValue) {
            FormUtils.handleValueChange(input_connect_search_monitoring_state);
        });

        var input_connect_modify_grace_period = new TextInput({
            "id": "input_connect_modify_grace_period",
            "searchWhenChanged": true,
            "value": "$form.modify_tk_connect_grace_period$",
            "el": $('#input_connect_modify_grace_period')
        }, {
            tokens: true
        }).render();

        input_connect_modify_grace_period.on("change", function(newValue) {
            FormUtils.handleValueChange(input_connect_modify_grace_period);
        });

        //
        // BURROW
        //

        var input_burrow_search_env = new DropdownInput({
            "id": "input_burrow_search_env",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "env",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "env=\"",
            "valueField": "env",
            "value": "$form.search_tk_burrow_env$",
            "managerid": "search_burrow_search_env",
            "el": $('#input_burrow_search_env')
        }, {
            tokens: true
        }).render();

        input_burrow_search_env.on("change", function(newValue) {
            FormUtils.handleValueChange(input_burrow_search_env);
        });

        var input_burrow_search_label = new DropdownInput({
            "id": "input_burrow_search_label",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "label",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "label=\"",
            "valueField": "label",
            "value": "$form.search_tk_burrow_label$",
            "managerid": "search_burrow_search_label",
            "el": $('#input_burrow_search_label')
        }, {
            tokens: true
        }).render();

        input_burrow_search_label.on("change", function(newValue) {
            FormUtils.handleValueChange(input_burrow_search_label);
        });

        var input_burrow_search_cluster = new DropdownInput({
            "id": "input_burrow_search_cluster",
            "choices": [{
                "value": "*",
                "label": "ANY"
            }],
            "default": "*",
            "searchWhenChanged": true,
            "labelField": "cluster",
            "showClearButton": true,
            "selectFirstChoice": false,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "cluster=\"",
            "valueField": "cluster",
            "value": "$form.search_tk_burrow_cluster$",
            "managerid": "search_burrow_search_cluster",
            "el": $('#input_burrow_search_cluster')
        }, {
            tokens: true
        }).render();

        input_burrow_search_cluster.on("change", function(newValue) {
            FormUtils.handleValueChange(input_burrow_search_cluster);
        });

        var input_burrow_search_monitoring_state = new DropdownInput({
            "id": "input_burrow_search_monitoring_state",
            "choices": [{
                    "label": "ANY",
                    "value": "*"
                },
                {
                    "label": "enabled",
                    "value": "enabled"
                },
                {
                    "label": "disabled",
                    "value": "disabled"
                }
            ],
            "searchWhenChanged": true,
            "default": "*",
            "prefix": "monitoring_state=\"",
            "initialValue": "*",
            "selectFirstChoice": false,
            "suffix": "\"",
            "showClearButton": true,
            "value": "$form.search_tk_burrow_monitoring_state$",
            "el": $('#input_burrow_search_monitoring_state')
        }, {
            tokens: true
        }).render();

        input_burrow_search_monitoring_state.on("change", function(newValue) {
            FormUtils.handleValueChange(input_burrow_search_monitoring_state);
        });

        var input_burrow_search_name = new TextInput({
            "id": "input_burrow_search_name",
            "searchWhenChanged": true,
            "initialValue": "*",
            "suffix": "\"",
            "prefix": "group=\"",
            "value": "$form.search_tk_burrow_name$",
            "el": $('#input_burrow_search_name')
        }, {
            tokens: true
        }).render();

        input_burrow_search_name.on("change", function(newValue) {
            FormUtils.handleValueChange(input_burrow_search_name);
        });

        //
        // others
        //

        DashboardController.onReady(function() {
            if (!submittedTokenModel.has('earliest') && !submittedTokenModel.has('latest')) {
                submittedTokenModel.set({
                    earliest: '0',
                    latest: ''
                });
            }
        });

        // Initialize time tokens to default
        if (!defaultTokenModel.has('earliest') && !defaultTokenModel.has('latest')) {
            defaultTokenModel.set({
                earliest: '0',
                latest: ''
            });
        }

        if (!_.isEmpty(urlTokenModel.toJSON())) {
            submitTokens();
        }

        //
        // DASHBOARD READY
        //

        DashboardController.ready();
        pageLoading = false;

        //
        // SERVICE OBJECT
        //

        // Create a service object using the Splunk SDK for JavaScript
        // to send REST requests
        var service = mvc.createService({
            owner: "nobody"
        });

        //
        // ALERT SUMMARY
        //

        $("#btn_refresh_kafka_alerts").click(function() {
            submitTokens();
            search_kafka_alerts_main_table.startSearch();
        });

        //
        // MAINTENANCE MODE
        //

        // Manage buttons states dynamically

        submitTokens();

        // When the Submit button is clicked, get all the form fields by accessing token values
        var tokens = mvc.Components.get("default");

        //
        // Verify the current status
        //

        // Define the query
        var searchQuery = "| savedsearch \"Verify Kafka alerting maintenance status\" | eval maintenance_mode=if(now()<maintenance_mode_start AND maintenance_mode_end>now(), \"scheduled\", maintenance_mode)";

        // Set the search parameters--specify a time range
        var searchParams = {
            earliest_time: "-60m",
            latest_time: "now"
        };

        // Run a oneshot search that returns the job's results
        service.oneshotSearch(
            searchQuery,
            searchParams,
            function(err, results) {

                // Display the results
                var fields = results.fields;
                var rows = results.rows;
                var current_maintenance_mode;
                var current_time_updated;

                for (var i = 0; i < rows.length; i++) {
                    var values = rows[i];
                    //console.log("Row " + i + ": ");

                    for (var j = 0; j < values.length; j++) {
                        var field = fields[j];

                        if (fields[j] == "maintenance_mode") {
                            current_maintenance_mode = values[j];
                        }
                        if (fields[j] == "time_updated") {
                            current_time_updated = values[j];
                        }

                        //console.log("current_maintenance_mode: " + current_maintenance_mode + " ,current_time_updated: " + current_time_updated);
                    }
                }

                if (!current_maintenance_mode) {
                    $("#modal_loading_maintenance_mode_failure").modal()
                    document.getElementById('btn_press_enable_maintenance').disabled = true;
                    document.getElementById('btn_press_disable_maintenance').disabled = true;
                    return;
                }

                // Dynamically manage buttons states
                if (current_maintenance_mode == "disabled") {
                    //console.log("maintenance_mode is disabled");
                    document.getElementById('btn_press_disable_maintenance').disabled = true;
                    document.getElementById('btn_press_enable_maintenance').disabled = false;
                }
                else if (current_maintenance_mode == "scheduled") {
                    document.getElementById('btn_press_disable_maintenance').disabled = false;
                    document.getElementById('btn_press_enable_maintenance').disabled = true;
                }
                else {
                    //console.log("maintenance_mode is enabled");
                    document.getElementById('btn_press_disable_maintenance').disabled = false;
                    document.getElementById('btn_press_enable_maintenance').disabled = true;
                }

            });

        //
        // ENABLE MAINTENANCE MODE BUTTON
        //

        $("#btn_enable_maintenance").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#enable_maintenance_endtime").modal()

            // Disabled past selection
            $(function() {
                var dtToday = new Date();

                var month = dtToday.getMonth() + 1;
                var day = dtToday.getDate();
                var year = dtToday.getFullYear();
                if (month < 10)
                    month = '0' + month.toString();
                if (day < 10)
                    day = '0' + day.toString();

                var maxDate = year + '-' + month + '-' + day;

                // preset today's date
                document.getElementById('inputStartMaintenance').valueAsDate = new Date();

                // define minimal date that can be selected
                $('#inputEndMaintenance').attr('min', maxDate);

            });

            $("#btn_enable_maintenance_endtime").click(function() {

                // Retrieve start date
                var inputStartMaintenance = document.getElementById("inputStartMaintenance").value;

                // Retrieve start time
                var inputStartMaintenanceTime = tokens.get("time_start_maintenance");

                // Retrieve end date
                var inputEndMaintenance = document.getElementById("inputEndMaintenance").value;

                // Retrieve end time
                var inputEndMaintenanceTime = tokens.get("time_end_maintenance");

                // Validation submitted with no date entry
                if (!inputStartMaintenance || inputStartMaintenance == "YYYY-MM-DD" || !inputStartMaintenanceTime || !inputEndMaintenance || inputEndMaintenance == "YYYY-MM-DD" || !inputEndMaintenanceTime) {
                    $("#maintenance_mode_data_is_invalid").modal()
                    return;
                }

                if (inputStartMaintenance && inputEndMaintenance) {

                    //
                    // Verify that the end date selection is not in the past time
                    //

                    // Define the query
                    var searchQuery = "| makeresults | eval start_date=\"" + inputStartMaintenance + "\", start_time=\"" + inputStartMaintenanceTime + "\", end_date=\"" + inputEndMaintenance + "\", end_time=\"" + inputEndMaintenanceTime + "\" | eval maintenance_mode_start=start_date . \" \" . start_time, maintenance_mode_end=end_date . \" \" . end_time | eval maintenance_mode_start=round(strptime(maintenance_mode_start, \"%Y-%m-%d %H:%M\"), 0), maintenance_mode_end=round(strptime(maintenance_mode_end, \"%Y-%m-%d %H:%M\"), 0), now=now() | eval is_invalid=case(now>=maintenance_mode_end, \"true\", maintenance_mode_start>maintenance_mode_end, \"true\", maintenance_mode_end>now, \"false\") | fields - _time | fields is_invalid";

                    //console.log("searchQuery is : " + searchQuery);

                    // Set the search parameters--specify a time range
                    var searchParams = {
                        earliest_time: "-60m",
                        latest_time: "now"
                    };

                    // Run a oneshot search that returns the job's results

                    service.oneshotSearch(
                        searchQuery,
                        searchParams,
                        function(err, results) {
                            // Display the results
                            var fields = results.fields;
                            var rows = results.rows;
                            var is_in_the_past;

                            for (var i = 0; i < rows.length; i++) {
                                var values = rows[i];
                                //console.log("Row " + i + ": ");

                                for (var j = 0; j < values.length; j++) {
                                    var field = fields[j];

                                    if (fields[j] == "is_invalid") {
                                        is_invalid = values[j];
                                    }

                                    //console.log("is_in_the_past is: " + is_in_the_past);
                                }
                            }

                            if (is_invalid === "true") {
                                $("#maintenance_mode_date_is_invalid").modal()
                                return;
                            } else {

                                if (inputStartMaintenanceTime == "now") {
                                    //console.log("Enabling maintenance mode now");
                                    var searchQuery = "| makeresults | eval maintenance_mode=\"enabled\", time_updated=now(), end_date=\"" + inputEndMaintenance + "\", end_time=\"" + inputEndMaintenanceTime + "\" | eval maintenance_mode_end=end_date . \" \" . end_time | eval maintenance_mode_end=round(strptime(maintenance_mode_end, \"%Y-%m-%d %H:%M\"), 0) | fields - _time | fields maintenance_mode, time_updated, maintenance_mode_end | outputlookup kafka_alerting_maintenance";
                                }

                                else {
                                    //console.log("Enabling maintenance mode as scheduled");
                                    var searchQuery = "| makeresults | eval maintenance_mode=\"disabled\", time_updated=now(), start_date=\"" + inputStartMaintenance  + "\", start_time=\"" + inputStartMaintenanceTime + "\", end_date=\"" + inputEndMaintenance + "\", end_time=\"" + inputEndMaintenanceTime + "\" | eval maintenance_mode_start=start_date . \" \" . start_time, maintenance_mode_end=end_date . \" \" . end_time | eval maintenance_mode_start=round(strptime(maintenance_mode_start, \"%Y-%m-%d %H:%M\"), 0), maintenance_mode_end=round(strptime(maintenance_mode_end, \"%Y-%m-%d %H:%M\"), 0) | fields - _time | fields maintenance_mode, time_updated, maintenance_mode_start, maintenance_mode_end | eval maintenance_mode=if(now()>=maintenance_mode_start AND maintenance_mode_end>now(), \"enabled\", maintenance_mode) | outputlookup kafka_alerting_maintenance";
                                }

                                //console.log("searchQuery is " + searchQuery);

                                // Set the search parameters--specify a time range
                                var searchParams = {
                                    earliest_time: "-60m",
                                    latest_time: "now"
                                };

                                // Update the collection
                                service.search(
                                    searchQuery,
                                    searchParams,
                                    function(err, job) {

                                        // Poll the status of the search job
                                        job.track({
                                            period: 200
                                        }, {
                                            done: function(job) {
                                                //console.log("Done!");

                                                // Update single
                                                search_maintenance_mode_mainsearch.startSearch();
                                                search_maintenance_state.startSearch();

                                                //
                                                // Verify the current status and update buttons state
                                                //

                                                // Define the query
                                                var searchQuery = "| inputlookup kafka_alerting_maintenance | eval maintenance_mode=if(now()<maintenance_mode_start AND maintenance_mode_end>now(), \"scheduled\", maintenance_mode)";

                                                // Set the search parameters--specify a time range
                                                var searchParams = {
                                                    earliest_time: "-60m",
                                                    latest_time: "now"
                                                };

                                                // Run a oneshot search that returns the job's results
                                                service.oneshotSearch(
                                                    searchQuery,
                                                    searchParams,
                                                    function(err, results) {

                                                        // Display the results
                                                        var fields = results.fields;
                                                        var rows = results.rows;
                                                        var current_maintenance_mode;
                                                        var current_time_updated;

                                                        for (var i = 0; i < rows.length; i++) {
                                                            var values = rows[i];
                                                            //console.log("Row " + i + ": ");

                                                            for (var j = 0; j < values.length; j++) {
                                                                var field = fields[j];

                                                                if (fields[j] == "maintenance_mode") {
                                                                    current_maintenance_mode = values[j];
                                                                }
                                                                if (fields[j] == "time_updated") {
                                                                    current_time_updated = values[j];
                                                                }

                                                                //console.log("current_maintenance_mode: " + current_maintenance_mode + " ,current_time_updated: " + current_time_updated);
                                                            }
                                                        }

                                                        if (!current_maintenance_mode) {
                                                            $("#modal_loading_maintenance_mode_failure").modal()
                                                            document.getElementById('btn_press_enable_maintenance').disabled = true;
                                                            document.getElementById('btn_press_disable_maintenance').disabled = true;
                                                            return;
                                                        }

                                                        // Dynamically manage buttons states
                                                        if (current_maintenance_mode == "disabled") {
                                                            //console.log("maintenance_mode is disabled");
                                                            document.getElementById('btn_press_disable_maintenance').disabled = true;
                                                            document.getElementById('btn_press_enable_maintenance').disabled = false;
                                                        }
                                                        else if (current_maintenance_mode == "scheduled") {
                                                            document.getElementById('btn_press_disable_maintenance').disabled = false;
                                                            document.getElementById('btn_press_enable_maintenance').disabled = true;
                                                        }
                                                        else {
                                                            //console.log("maintenance_mode is enabled");
                                                            document.getElementById('btn_press_disable_maintenance').disabled = false;
                                                            document.getElementById('btn_press_enable_maintenance').disabled = true;
                                                        }

                                                    });

                                            },
                                            failed: function(properties) {
                                                let errorStr = "Unknown Error!";
                                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                                    errorStr = properties._properties.messages[0]['text'];
                                                } else if (properties && properties._properties && properties._properties.messages) {
                                                    errorStr = JSON.stringify(properties._properties.messages);
                                                }
                                                $("#loadingGray").remove()
                                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                                $("#modal_update_collection_failure_return").modal()
                                            },
                                            error: function(err) {
                                                done(err);
                                                $("#modal_maintenance_mode_failure").modal()
                                            }
                                        });
                                    }
                                );

                                // Clear date inputs
                                $("input[type=date]").val("");

                                // Show confirmed modal

                                if (inputStartMaintenanceTime == "now") {
                                    $("#modal_maintenance_mode_confirmed").modal()
                                }
                                else {
                                    $("#modal_maintenance_mode_scheduled").modal()
                                }


                            }

                        });

                }

                // end modal calendar selection
            });

        });

        //
        // DISABLE MAINTENANCE MODE BUTTON
        //

        $("#btn_disable_maintenance").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#disabled_maintenance_confirmation").modal()

            $("#btn_disable_maintenance_confirmation").click(function() {

                //console.log("Disable maintenance mode now");
                var searchQuery = "| makeresults | eval maintenance_mode=\"disabled\", time_updated=now(), maintenance_mode_end=\"\" | fields - _time | outputlookup kafka_alerting_maintenance";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-60m",
                    latest_time: "now"
                };

                // Update the collection
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        // Poll the status of the search job
                        job.track({
                            period: 200
                        }, {
                            done: function(job) {
                                //console.log("Done!");

                                // Update single
                                search_maintenance_mode_mainsearch.startSearch();
                                search_maintenance_state.startSearch();
                                // buttons states
                                document.getElementById('btn_press_disable_maintenance').disabled = true;
                                document.getElementById('btn_press_enable_maintenance').disabled = false;

                                // Show final modal
                                $("#modal_maintenance_mode_disabled").modal()

                            },
                            failed: function(properties) {
                                let errorStr = "Unknown Error!";
                                if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                    errorStr = properties._properties.messages[0]['text'];
                                } else if (properties && properties._properties && properties._properties.messages) {
                                    errorStr = JSON.stringify(properties._properties.messages);
                                }
                                $("#loadingGray").remove()
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                $("#modal_update_collection_failure_return").modal()
                            },
                            error: function(err) {
                                done(err);
                                $("#modal_maintenance_mode_failure").modal()
                            }
                        });
                    }
                );
            });

        });

        //
        // KAFKA TOPICS
        //

        //
        // UPDATE COLLECTION
        //

        // Call this function when the Update collection button is clicked

        $("#btn_manage_content_kafka_topics1").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_update_collection").modal()

            $("#btn_modal_update_collection").click(function() {

                //console.log("Start collection update");

                // Define the query
                var searchQuery = "| savedsearch \"Update Kafka topics inventory\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a normal search that immediately returns the job's SID
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    //console.log("Done!");

                                    // Once the job is done, update all searches
                                    search_kafka_topics_mainsearch.startSearch();
                                    search_kafka_topics_no_components.startSearch();
                                    search_kafka_topics_no_components_enabled.startSearch();
                                    search_kafka_topics_no_components_disabled.startSearch();
                                    search_kafka_topics_main_table.startSearch();
                                    search_kafka_topics_search_env.startSearch();
                                    search_kafka_topics_search_label.startSearch();

                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_done").modal()

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure").modal()
                                }
                            });
                        }
                    }
                );
            });
        });

        //
        // RESET COLLECTION
        //

        // Call this function when the erase collection button is clicked
        $("#btn_manage_content_kafka_topics2").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_rebuild_collection").modal()

            $("#btn_modal_rebuild_collection").click(function() {

                // Define the query
                var searchQuery = "| outputlookup kafka_topics_monitoring";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Flushing and updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {

                                    // Define the query
                                    var searchQuery = "| savedsearch \"Update Kafka topics inventory\"";

                                    // Set the search parameters--specify a time range
                                    var searchParams = {
                                        earliest_time: "-4h",
                                        latest_time: "now"
                                    };

                                    // Run a normal search that immediately returns the job's SID
                                    service.search(
                                        searchQuery,
                                        searchParams,
                                        function(err, job) {

                                            // Poll the status of the search job
                                            job.track({
                                                period: 200
                                            }, {
                                                done: function(job) {
                                                    //console.log("Done!");

                                                    // Once the job is done, update all searches
                                                    search_kafka_topics_mainsearch.startSearch();
                                                    search_kafka_topics_no_components.startSearch();
                                                    search_kafka_topics_no_components_enabled.startSearch();
                                                    search_kafka_topics_no_components_disabled.startSearch();
                                                    search_kafka_topics_main_table.startSearch();
                                                    search_kafka_topics_search_env.startSearch();
                                                    search_kafka_topics_search_label.startSearch();

                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_done").modal()

                                                },
                                                failed: function(properties) {
                                                    let errorStr = "Unknown Error!";
                                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                                        errorStr = properties._properties.messages[0]['text'];
                                                    } else if (properties && properties._properties && properties._properties.messages) {
                                                        errorStr = JSON.stringify(properties._properties.messages);
                                                    }
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                                    $("#modal_update_collection_failure_return").modal()
                                                },
                                                error: function(err) {
                                                    done(err);
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure").modal()
                                                }

                                            });

                                        }
                                    );

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

            });

        });

        //
        // DELETE BUTTON
        //

        // delete entry

        $("#btn_delete_modal_manage_kafka_topic").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_topics").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var modify_key = tokens.get("tk_kafka_topic_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_topics_monitoring/" + modify_key;

            if (modify_key && modify_key.length) {

                $("#modal_entry_deletion").modal()
                $("#btn_modal_entry_deletion").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_topics_mainsearch.startSearch();
                            search_kafka_topics_no_components.startSearch();
                            search_kafka_topics_no_components_enabled.startSearch();
                            search_kafka_topics_no_components_disabled.startSearch();
                            search_kafka_topics_main_table.startSearch();
                            search_kafka_topics_search_env.startSearch();
                            search_kafka_topics_search_label.startSearch();

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            modify_key = undefined;
                            delete(modify_key);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

            }

        });

        //
        // MODIFY BUTTON
        //

        // enable monitoring

        $("#btn_enable_modal_manage_kafka_topic").click(function(mode) {

            // Hide main modal
            $("#modal_manage_kafka_topics").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_kafka_topic_keyid");
            var tk_kafka_topic_name = tokens.get("tk_kafka_topic_name");
            var tk_kafka_topic_env = tokens.get("tk_kafka_topic_env");
            var tk_kafka_topic_label = tokens.get("tk_kafka_topic_label");
            var tk_kafka_topic_monitoring_state = "enabled";

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_topics_monitoring/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "topic": tk_kafka_topic_name,
                "env": tk_kafka_topic_env,
                "label": tk_kafka_topic_label,
                "monitoring_state": tk_kafka_topic_monitoring_state
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_topics_mainsearch.startSearch();
                            search_kafka_topics_no_components.startSearch();
                            search_kafka_topics_no_components_enabled.startSearch();
                            search_kafka_topics_no_components_disabled.startSearch();
                            search_kafka_topics_main_table.startSearch();
                            search_kafka_topics_search_env.startSearch();
                            search_kafka_topics_search_label.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // disable monitoring

        $("#btn_disable_modal_manage_kafka_topic").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_topics").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_kafka_topic_keyid");
            var tk_kafka_topic_name = tokens.get("tk_kafka_topic_name");
            var tk_kafka_topic_env = tokens.get("tk_kafka_topic_env");
            var tk_kafka_topic_label = tokens.get("tk_kafka_topic_label");
            var tk_kafka_topic_monitoring_state = "disabled";

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_topics_monitoring/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "topic": tk_kafka_topic_name,
                "env": tk_kafka_topic_env,
                "label": tk_kafka_topic_label,
                "monitoring_state": tk_kafka_topic_monitoring_state
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_topics_mainsearch.startSearch();
                            search_kafka_topics_no_components.startSearch();
                            search_kafka_topics_no_components_enabled.startSearch();
                            search_kafka_topics_no_components_disabled.startSearch();
                            search_kafka_topics_main_table.startSearch();
                            search_kafka_topics_search_env.startSearch();
                            search_kafka_topics_search_label.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        //
        // KAFKA INFRA
        //

        //
        // UPDATE COLLECTION
        //

        // Call this function when the Update collection button is clicked

        $("#btn_manage_content_kafka_infra1").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_update_collection").modal()

            $("#btn_modal_update_collection").click(function() {

                //console.log("Start collection update");

                // Define the query
                var searchQuery = "| savedsearch \"Update Kafka Infrastructure components inventory\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a normal search that immediately returns the job's SID
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    //console.log("Done!");

                                    // Once the job is done, update all searches
                                    search_kafka_infra_mainsearch.startSearch();
                                    search_kafka_infra_no_components.startSearch();
                                    search_kafka_infra_no_components_enabled.startSearch();
                                    search_kafka_infra_no_components_disabled.startSearch();
                                    search_kafka_infra_main_table.startSearch();
                                    search_kafka_infra_search_env.startSearch();
                                    search_kafka_infra_search_label.startSearch();

                                    // this shares the same KVstore collection maintenance object
                                    search_kafka_infra_nodes_mainsearch.startSearch();
                                    search_kafka_infra_nodes_no_components.startSearch();
                                    search_kafka_infra_nodes_no_components_enabled.startSearch();
                                    search_kafka_infra_nodes_no_components_disabled.startSearch();
                                    search_kafka_infra_nodes_main_table.startSearch();
                                    search_kafka_infra_nodes_search_env.startSearch();
                                    search_kafka_infra_nodes_search_label.startSearch();

                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_done").modal()

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure").modal()
                                }
                            });
                        }
                    }
                );
            });
        });

        //
        // RESET COLLECTION
        //

        // Call this function when the erase collection button is clicked
        $("#btn_manage_content_kafka_infra2").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_rebuild_collection").modal()

            $("#btn_modal_rebuild_collection").click(function() {

                // Define the query
                var searchQuery = "| outputlookup kafka_infra_inventory";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Flushing and updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {

                                    // Define the query
                                    var searchQuery = "| savedsearch \"Update Kafka Infrastructure components inventory\"";

                                    // Set the search parameters--specify a time range
                                    var searchParams = {
                                        earliest_time: "-4h",
                                        latest_time: "now"
                                    };

                                    // Run a normal search that immediately returns the job's SID
                                    service.search(
                                        searchQuery,
                                        searchParams,
                                        function(err, job) {

                                            // Poll the status of the search job
                                            job.track({
                                                period: 200
                                            }, {
                                                done: function(job) {
                                                    //console.log("Done!");

                                                    // Once the job is done, update all searches
                                                    search_kafka_infra_mainsearch.startSearch();
                                                    search_kafka_infra_no_components.startSearch();
                                                    search_kafka_infra_no_components_enabled.startSearch();
                                                    search_kafka_infra_no_components_disabled.startSearch();
                                                    search_kafka_infra_main_table.startSearch();
                                                    search_kafka_infra_search_env.startSearch();
                                                    search_kafka_infra_search_label.startSearch();

                                                    // this shares the same KVstore collection maintenance object
                                                    search_kafka_infra_nodes_mainsearch.startSearch();
                                                    search_kafka_infra_nodes_no_components.startSearch();
                                                    search_kafka_infra_nodes_no_components_enabled.startSearch();
                                                    search_kafka_infra_nodes_no_components_disabled.startSearch();
                                                    search_kafka_infra_nodes_main_table.startSearch();
                                                    search_kafka_infra_nodes_search_env.startSearch();
                                                    search_kafka_infra_nodes_search_label.startSearch();

                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_done").modal()

                                                },
                                                failed: function(properties) {
                                                    let errorStr = "Unknown Error!";
                                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                                        errorStr = properties._properties.messages[0]['text'];
                                                    } else if (properties && properties._properties && properties._properties.messages) {
                                                        errorStr = JSON.stringify(properties._properties.messages);
                                                    }
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                                    $("#modal_update_collection_failure_return").modal()
                                                },
                                                error: function(err) {
                                                    done(err);
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure").modal()
                                                }

                                            });

                                        }
                                    );

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

            });

        });

        //
        // DELETE BUTTON
        //

        // delete entry

        $("#btn_delete_modal_manage_kafka_infra1").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_infra1").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var modify_key = tokens.get("tk_kafka_infra_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_inventory/" + modify_key;

            if (modify_key && modify_key.length) {

                $("#modal_entry_deletion").modal()
                $("#btn_modal_entry_deletion").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_infra_mainsearch.startSearch();
                            search_kafka_infra_no_components.startSearch();
                            search_kafka_infra_no_components_enabled.startSearch();
                            search_kafka_infra_no_components_disabled.startSearch();
                            search_kafka_infra_main_table.startSearch();
                            search_kafka_infra_search_env.startSearch();
                            search_kafka_infra_search_label.startSearch();

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            modify_key = undefined;
                            delete(modify_key);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

            }

        });

        //
        // MODIFY BUTTON
        //

        // enable monitoring

        $("#btn_enable_modal_manage_kafka_infra1").click(function(mode) {

            // Hide main modal
            $("#modal_manage_kafka_infra1").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_kafka_infra_keyid");
            var tk_name = tokens.get("tk_kafka_infra_name");
            var tk_role = tokens.get("tk_kafka_infra_role");
            var tk_kafka_infra_env = tokens.get("tk_kafka_infra_env");
            var tk_kafka_infra_label = tokens.get("tk_kafka_infra_label");
            var tk_lasttime = tokens.get("tk_kafka_infra_lasttime");
            var tk_kafka_infra_grace_period = tokens.get("tk_kafka_infra_grace_period");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_inventory/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "name": tk_name,
                "role": tk_role,
                "env": tk_kafka_infra_env,
                "label": tk_kafka_infra_label,
                "grace_period": tk_kafka_infra_grace_period,
                "monitoring_state": "enabled",
                "lasttime": tk_lasttime
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else if (!tk_kafka_infra_grace_period || !tk_kafka_infra_grace_period.length || !isNumeric(tk_kafka_infra_grace_period)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_infra_mainsearch.startSearch();
                            search_kafka_infra_no_components.startSearch();
                            search_kafka_infra_no_components_enabled.startSearch();
                            search_kafka_infra_no_components_disabled.startSearch();
                            search_kafka_infra_main_table.startSearch();
                            search_kafka_infra_search_env.startSearch();
                            search_kafka_infra_search_label.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // disable monitoring

        $("#btn_disable_modal_manage_kafka_infra1").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_infra1").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_kafka_infra_keyid");
            var tk_name = tokens.get("tk_kafka_infra_name");
            var tk_role = tokens.get("tk_kafka_infra_role");
            var tk_kafka_infra_env = tokens.get("tk_kafka_infra_env");
            var tk_kafka_infra_label = tokens.get("tk_kafka_infra_label");
            var tk_lasttime = tokens.get("tk_kafka_infra_lasttime");
            var tk_kafka_infra_grace_period = tokens.get("tk_kafka_infra_grace_period");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_inventory/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "name": tk_name,
                "role": tk_role,
                "env": tk_kafka_infra_env,
                "label": tk_kafka_infra_label,
                "grace_period": tk_kafka_infra_grace_period,
                "monitoring_state": "disabled",
                "lasttime": tk_lasttime
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else if (!tk_kafka_infra_grace_period || !tk_kafka_infra_grace_period.length || !isNumeric(tk_kafka_infra_grace_period)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_infra_mainsearch.startSearch();
                            search_kafka_infra_no_components.startSearch();
                            search_kafka_infra_no_components_enabled.startSearch();
                            search_kafka_infra_no_components_disabled.startSearch();
                            search_kafka_infra_main_table.startSearch();
                            search_kafka_infra_search_env.startSearch();
                            search_kafka_infra_search_label.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // modify grace period

        $("#btn_modify_modal_manage_kafka_infra1").click(function() {
            submitTokens();

            // Hide main modal
            $("#modal_manage_kafka_infra1").modal('hide');

            // Show input modal
            $("#modal_modify_grace_period").modal();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var modify_key = tokens.get("tk_kafka_infra_keyid");
            var tk_name = tokens.get("tk_kafka_infra_name");
            var tk_role = tokens.get("tk_kafka_infra_role");
            var tk_kafka_infra_env = tokens.get("tk_kafka_infra_env");
            var tk_kafka_infra_label = tokens.get("tk_kafka_infra_label");
            var tk_lasttime = tokens.get("tk_kafka_infra_lasttime");
            var tk_kafka_infra_grace_period = tokens.get("modal_input_grace_period");
            var tk_kafka_infra_monitoring_state = tokens.get("tk_kafka_infra_monitoring_state");

            //console.log("Value of modal_input_grace_period is: " + tk_kafka_infra_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_inventory/" + modify_key;

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else if (!tk_kafka_infra_monitoring_state || !tk_kafka_infra_monitoring_state.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#btn_modal_modify_grace_period").click(function() {

                    var tk_kafka_infra_grace_period = tokens.get("modal_input_grace_period");

                    if (!tk_kafka_infra_grace_period || !tk_kafka_infra_grace_period.length || !isNumeric(tk_kafka_infra_grace_period)) {
                        // Show an error message
                        $("#modal_entry_update_invalid").modal()
                        return;
                    } else {

                        // Create a dictionary to store the field names and values
                        var record = {
                            "name": tk_name,
                            "role": tk_role,
                            "env": tk_kafka_infra_env,
                            "label": tk_kafka_infra_label,
                            "grace_period": tk_kafka_infra_grace_period,
                            "monitoring_state": tk_kafka_infra_monitoring_state,
                            "lasttime": tk_lasttime
                        };

                        var that = $(this);
                        that.off('click'); // remove handler

                        $.ajax({
                            url: myendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                search_kafka_infra_mainsearch.startSearch();
                                search_kafka_infra_no_components.startSearch();
                                search_kafka_infra_no_components_enabled.startSearch();
                                search_kafka_infra_no_components_disabled.startSearch();
                                search_kafka_infra_main_table.startSearch();
                                search_kafka_infra_search_env.startSearch();
                                search_kafka_infra_search_label.startSearch();
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }
                        });

                    }
                });

            }

        });

        //
        // KAFKA INFRA NODES
        //

        //
        // UPDATE COLLECTION
        //

        // Call this function when the Update collection button is clicked

        $("#btn_manage_content_kafka_infra_nodenumber1").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_update_collection").modal()

            $("#btn_modal_update_collection").click(function() {

                //console.log("Start collection update");

                // Define the query
                var searchQuery = "| savedsearch \"Update Kafka Infrastructure components inventory\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a normal search that immediately returns the job's SID
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    //console.log("Done!");

                                    // Once the job is done, update all searches
                                    search_kafka_infra_nodes_mainsearch.startSearch();
                                    search_kafka_infra_nodes_no_components.startSearch();
                                    search_kafka_infra_nodes_no_components_enabled.startSearch();
                                    search_kafka_infra_nodes_no_components_disabled.startSearch();
                                    search_kafka_infra_nodes_main_table.startSearch();
                                    search_kafka_infra_nodes_search_env.startSearch();
                                    search_kafka_infra_nodes_search_label.startSearch();

                                    // This shares the same KVstore collection maintenance object
                                    search_kafka_infra_no_components.startSearch();
                                    search_kafka_infra_no_components_enabled.startSearch();
                                    search_kafka_infra_no_components_disabled.startSearch();
                                    search_kafka_infra_mainsearch.startSearch();
                                    search_kafka_infra_main_table.startSearch();
                                    search_kafka_infra_search_env.startSearch();
                                    search_kafka_infra_search_label.startSearch();

                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_done").modal()

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure").modal()
                                }
                            });
                        }
                    }
                );
            });
        });

        //
        // RESET COLLECTION
        //

        // Call this function when the erase collection button is clicked
        $("#btn_manage_content_kafka_infra_nodenumber2").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_rebuild_collection").modal()

            $("#btn_modal_rebuild_collection").click(function() {

                // Define the query
                var searchQuery = "| outputlookup kafka_infra_nodes_inventory";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Flushing and updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {

                                    // Define the query
                                    var searchQuery = "| savedsearch \"Update Kafka Infrastructure components inventory\"";

                                    // Set the search parameters--specify a time range
                                    var searchParams = {
                                        earliest_time: "-4h",
                                        latest_time: "now"
                                    };

                                    // Run a normal search that immediately returns the job's SID
                                    service.search(
                                        searchQuery,
                                        searchParams,
                                        function(err, job) {

                                            // Poll the status of the search job
                                            job.track({
                                                period: 200
                                            }, {
                                                done: function(job) {
                                                    //console.log("Done!");

                                                    // Once the job is done, update all searches
                                                    search_kafka_infra_nodes_mainsearch.startSearch();
                                                    search_kafka_infra_nodes_no_components.startSearch();
                                                    search_kafka_infra_nodes_no_components_enabled.startSearch();
                                                    search_kafka_infra_nodes_no_components_disabled.startSearch();
                                                    search_kafka_infra_nodes_main_table.startSearch();
                                                    search_kafka_infra_nodes_search_env.startSearch();
                                                    search_kafka_infra_nodes_search_label.startSearch();

                                                    // This shares the same KVstore collection maintenance object
                                                    search_kafka_infra_no_components.startSearch();
                                                    search_kafka_infra_no_components_enabled.startSearch();
                                                    search_kafka_infra_no_components_disabled.startSearch();
                                                    search_kafka_infra_mainsearch.startSearch();
                                                    search_kafka_infra_main_table.startSearch();
                                                    search_kafka_infra_search_env.startSearch();
                                                    search_kafka_infra_search_label.startSearch();

                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_done").modal()

                                                },
                                                failed: function(properties) {
                                                    let errorStr = "Unknown Error!";
                                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                                        errorStr = properties._properties.messages[0]['text'];
                                                    } else if (properties && properties._properties && properties._properties.messages) {
                                                        errorStr = JSON.stringify(properties._properties.messages);
                                                    }
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                                    $("#modal_update_collection_failure_return").modal()
                                                },
                                                error: function(err) {
                                                    done(err);
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure").modal()
                                                }

                                            });

                                        }
                                    );

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

            });

        });

        //
        // DELETE BUTTON
        //

        // delete entry

        $("#btn_delete_modal_manage_kafka_infra_nodes").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_infra_nodes").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var modify_key = tokens.get("tk_kafka_infra_nodes_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_kafka_infra_nodes_inventory/" + modify_key;

            if (modify_key && modify_key.length) {

                $("#modal_entry_deletion").modal()
                $("#btn_modal_entry_deletion").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_infra_nodes_mainsearch.startSearch();
                            search_kafka_infra_nodes_no_components.startSearch();
                            search_kafka_infra_nodes_no_components_enabled.startSearch();
                            search_kafka_infra_nodes_no_components_disabled.startSearch();
                            search_kafka_infra_nodes_main_table.startSearch();
                            search_kafka_infra_nodes_search_env.startSearch();
                            search_kafka_infra_nodes_search_label.startSearch();

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            modify_key = undefined;
                            delete(modify_key);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

            }

        });

        //
        // MODIFY BUTTON
        //

        // enable monitoring

        $("#btn_enable_modal_manage_kafka_infra_nodes").click(function(mode) {

            // Hide main modal
            $("#modal_manage_kafka_infra_nodes").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_kafka_infra_nodes_keyid");
            var tk_role = tokens.get("tk_kafka_infra_nodes_role");
            var tk_kafka_infra_nodes_env = tokens.get("tk_kafka_infra_nodes_env");
            var tk_kafka_infra_nodes_label = tokens.get("tk_kafka_infra_nodes_label");
            var tk_kafka_infra_nodes_current_nodes_number = tokens.get("tk_kafka_infra_nodes_current_nodes_number");
            var tk_kafka_infra_nodes_minimal_nodes_number = tokens.get("tk_kafka_infra_nodes_minimal_nodes_number");
            var tk_kafka_infra_nodes_monitoring_state = tokens.get("tk_kafka_infra_nodes_monitoring_state");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_kafka_infra_nodes_inventory/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "role": tk_role,
                "env": tk_kafka_infra_nodes_env,
                "label": tk_kafka_infra_nodes_label,
                "current_nodes_number": tk_kafka_infra_nodes_current_nodes_number,
                "minimal_nodes_number": tk_kafka_infra_nodes_minimal_nodes_number,
                "monitoring_state": "enabled"
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else if (!tk_kafka_infra_nodes_minimal_nodes_number || !tk_kafka_infra_nodes_minimal_nodes_number.length || !isNumeric(tk_kafka_infra_nodes_minimal_nodes_number)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else if (!tk_kafka_infra_nodes_monitoring_state || !tk_kafka_infra_nodes_monitoring_state.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_infra_nodes_mainsearch.startSearch();
                            search_kafka_infra_nodes_no_components.startSearch();
                            search_kafka_infra_nodes_no_components_enabled.startSearch();
                            search_kafka_infra_nodes_no_components_disabled.startSearch();
                            search_kafka_infra_nodes_main_table.startSearch();
                            search_kafka_infra_nodes_search_env.startSearch();
                            search_kafka_infra_nodes_search_label.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // disable monitoring

        $("#btn_disable_modal_manage_kafka_infra_nodes").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_infra_nodes").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_kafka_infra_nodes_keyid");
            var tk_role = tokens.get("tk_kafka_infra_nodes_role");
            var tk_kafka_infra_nodes_env = tokens.get("tk_kafka_infra_nodes_env");
            var tk_kafka_infra_nodes_label = tokens.get("tk_kafka_infra_nodes_label");
            var tk_kafka_infra_nodes_current_nodes_number = tokens.get("tk_kafka_infra_nodes_current_nodes_number");
            var tk_kafka_infra_nodes_minimal_nodes_number = tokens.get("tk_kafka_infra_nodes_minimal_nodes_number");
            var tk_kafka_infra_nodes_monitoring_state = tokens.get("tk_kafka_infra_nodes_monitoring_state");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_kafka_infra_nodes_inventory/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "role": tk_role,
                "env": tk_kafka_infra_nodes_env,
                "label": tk_kafka_infra_nodes_label,
                "current_nodes_number": tk_kafka_infra_nodes_current_nodes_number,
                "minimal_nodes_number": tk_kafka_infra_nodes_minimal_nodes_number,
                "monitoring_state": "disabled"
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else if (!tk_kafka_infra_nodes_minimal_nodes_number || !tk_kafka_infra_nodes_minimal_nodes_number.length || !isNumeric(tk_kafka_infra_nodes_minimal_nodes_number)) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else if (!tk_kafka_infra_nodes_monitoring_state || !tk_kafka_infra_nodes_monitoring_state.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_kafka_infra_nodes_mainsearch.startSearch();
                            search_kafka_infra_nodes_no_components.startSearch();
                            search_kafka_infra_nodes_no_components_enabled.startSearch();
                            search_kafka_infra_nodes_no_components_disabled.startSearch();
                            search_kafka_infra_nodes_main_table.startSearch();
                            search_kafka_infra_nodes_search_env.startSearch();
                            search_kafka_infra_nodes_search_label.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // modify minimal nodes number

        $("#btn_modify_modal_manage_kafka_infra_nodes").click(function() {
            submitTokens();

            // Hide main modal
            $("#modal_manage_kafka_infra_nodes").modal('hide');

            // Show input modal
            $("#modal_modify_minimal_nodes_number").modal();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var modify_key = tokens.get("tk_kafka_infra_nodes_keyid");
            var tk_role = tokens.get("tk_kafka_infra_nodes_role");
            var tk_kafka_infra_nodes_env = tokens.get("tk_kafka_infra_nodes_env");
            var tk_kafka_infra_nodes_label = tokens.get("tk_kafka_infra_nodes_label");
            var tk_kafka_infra_nodes_current_nodes_number = tokens.get("tk_kafka_infra_nodes_current_nodes_number");
            var tk_kafka_infra_nodes_minimal_nodes_number = tokens.get("tk_kafka_infra_nodes_minimal_nodes_number");
            var tk_kafka_infra_nodes_monitoring_state = tokens.get("tk_kafka_infra_nodes_monitoring_state");

            //console.log("Value of tk_kafka_infra_nodes_minimal_nodes_number is: " + tk_kafka_infra_nodes_minimal_nodes_number);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_kafka_infra_nodes_inventory/" + modify_key;

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else if (!tk_kafka_infra_nodes_minimal_nodes_number || !tk_kafka_infra_nodes_minimal_nodes_number.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#btn_modal_modify_minimal_nodes_number").click(function() {

                    var tk_kafka_infra_nodes_minimal_nodes_number = tokens.get("tk_input_infra_nodes_number");

                    //console.log("Value of tk_kafka_infra_nodes_minimal_nodes_number is: " + tk_kafka_infra_nodes_minimal_nodes_number);

                    if (!tk_kafka_infra_nodes_minimal_nodes_number || !tk_kafka_infra_nodes_minimal_nodes_number.length || !isNumeric(tk_kafka_infra_nodes_minimal_nodes_number)) {
                        // Show an error message
                        $("#modal_entry_update_invalid").modal()
                        return;
                    } else {

                        // Create a dictionary to store the field names and values
                        var record = {
                            "role": tk_role,
                            "env": tk_kafka_infra_nodes_env,
                            "label": tk_kafka_infra_nodes_label,
                            "current_nodes_number": tk_kafka_infra_nodes_current_nodes_number,
                            "minimal_nodes_number": tk_kafka_infra_nodes_minimal_nodes_number,
                            "monitoring_state": "disabled"
                        };

                        var that = $(this);
                        that.off('click'); // remove handler

                        $.ajax({
                            url: myendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                search_kafka_infra_nodes_mainsearch.startSearch();
                                search_kafka_infra_nodes_no_components.startSearch();
                                search_kafka_infra_nodes_no_components_enabled.startSearch();
                                search_kafka_infra_nodes_no_components_disabled.startSearch();
                                search_kafka_infra_nodes_main_table.startSearch();
                                search_kafka_infra_nodes_search_env.startSearch();
                                search_kafka_infra_nodes_search_label.startSearch();
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }
                        });

                    }
                });

            }

        });

        //
        // BURROW
        //

        //
        // UPDATE COLLECTION
        //

        // Call this function when the Update collection button is clicked

        $("#btn_manage_content_kafka_consumers1").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_update_collection").modal()

            $("#btn_modal_update_collection").click(function() {

                //console.log("Start collection update");

                // Define the query
                var searchQuery = "| savedsearch \"Update Kafka Burrow group consumers inventory\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a normal search that immediately returns the job's SID
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    //console.log("Done!");

                                    // Once the job is done, update all searches
                                    search_burrow_mainsearch.startSearch();
                                    search_burrow_no_consumers.startSearch();
                                    search_burrow_no_consumers_enabled.startSearch();
                                    search_burrow_no_consumers_disabled.startSearch();
                                    search_burrow_main_table.startSearch();
                                    search_burrow_search_env.startSearch();
                                    search_burrow_search_label.startSearch();
                                    search_burrow_search_cluster.startSearch();

                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_done").modal()

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure").modal()
                                }
                            });
                        }
                    }
                );
            });
        });

        //
        // RESET COLLECTION
        //

        // Call this function when the erase collection button is clicked
        $("#btn_manage_content_kafka_consumers2").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_rebuild_collection").modal()

            $("#btn_modal_rebuild_collection").click(function() {

                // Define the query
                var searchQuery = "| outputlookup kafka_burrow_consumers_monitoring";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Flushing and updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {

                                    // Define the query
                                    var searchQuery = "| savedsearch \"Update Kafka Burrow group consumers inventory\"";

                                    // Set the search parameters--specify a time range
                                    var searchParams = {
                                        earliest_time: "-4h",
                                        latest_time: "now"
                                    };

                                    // Run a normal search that immediately returns the job's SID
                                    service.search(
                                        searchQuery,
                                        searchParams,
                                        function(err, job) {

                                            // Poll the status of the search job
                                            job.track({
                                                period: 200
                                            }, {
                                                done: function(job) {
                                                    //console.log("Done!");

                                                    // Once the job is done, update all searches
                                                    search_burrow_mainsearch.startSearch();
                                                    search_burrow_no_consumers.startSearch();
                                                    search_burrow_no_consumers_enabled.startSearch();
                                                    search_burrow_no_consumers_disabled.startSearch();
                                                    search_burrow_main_table.startSearch();
                                                    search_burrow_search_env.startSearch();
                                                    search_burrow_search_label.startSearch();
                                                    search_burrow_search_cluster.startSearch();

                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_done").modal()

                                                },
                                                failed: function(properties) {
                                                    let errorStr = "Unknown Error!";
                                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                                        errorStr = properties._properties.messages[0]['text'];
                                                    } else if (properties && properties._properties && properties._properties.messages) {
                                                        errorStr = JSON.stringify(properties._properties.messages);
                                                    }
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                                    $("#modal_update_collection_failure_return").modal()
                                                },
                                                error: function(err) {
                                                    done(err);
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure").modal()
                                                }

                                            });

                                        }
                                    );

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

            });

        });

        //
        // DELETE BUTTON
        //

        // Call this function when the Delete Record button is clicked

        // delete entry

        $("#btn_delete_modal_manage_kafka_consumer").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_consumers").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var modify_key = tokens.get("tk_burrow_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_kafka_burrow_consumers_monitoring/" + modify_key;

            if (modify_key && modify_key.length) {

                $("#modal_entry_deletion").modal()
                $("#btn_modal_entry_deletion").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_burrow_mainsearch.startSearch();
                            search_burrow_no_consumers.startSearch();
                            search_burrow_no_consumers_enabled.startSearch();
                            search_burrow_no_consumers_disabled.startSearch();
                            search_burrow_main_table.startSearch();
                            search_burrow_search_env.startSearch();
                            search_burrow_search_label.startSearch();
                            search_burrow_search_cluster.startSearch();

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            modify_key = undefined;
                            delete(modify_key);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

            }

        });

        //
        // MODIFY BUTTON
        //

        // enable monitoring

        $("#btn_enable_modal_manage_kafka_consumer").click(function(mode) {

            // Hide main modal
            $("#modal_manage_kafka_consumers").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_burrow_keyid");
            var tk_burrow_env = tokens.get("tk_burrow_env");
            var tk_burrow_label = tokens.get("tk_burrow_label");
            var tk_burrow_cluster = tokens.get("tk_burrow_cluster");
            var tk_burrow_group = tokens.get("tk_burrow_group");
            var tk_burrow_monitoring_state = "enabled";

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_kafka_burrow_consumers_monitoring/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "env": tk_burrow_env,
                "label": tk_burrow_label,
                "cluster": tk_burrow_cluster,
                "group": tk_burrow_group,
                "monitoring_state": tk_burrow_monitoring_state
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_burrow_mainsearch.startSearch();
                            search_burrow_no_consumers.startSearch();
                            search_burrow_no_consumers_enabled.startSearch();
                            search_burrow_no_consumers_disabled.startSearch();
                            search_burrow_main_table.startSearch();
                            search_burrow_search_env.startSearch();
                            search_burrow_search_label.startSearch();
                            search_burrow_search_cluster.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // disable monitoring

        $("#btn_disable_modal_manage_kafka_consumer").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_consumers").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_burrow_keyid");
            var tk_burrow_env = tokens.get("tk_burrow_env");
            var tk_burrow_label = tokens.get("tk_burrow_label");
            var tk_burrow_cluster = tokens.get("tk_burrow_cluster");
            var tk_burrow_group = tokens.get("tk_burrow_group");
            var tk_burrow_monitoring_state = "disabled";

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_kafka_burrow_consumers_monitoring/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "env": tk_burrow_env,
                "label": tk_burrow_label,
                "cluster": tk_burrow_cluster,
                "group": tk_burrow_group,
                "monitoring_state": tk_burrow_monitoring_state
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_burrow_mainsearch.startSearch();
                            search_burrow_no_consumers.startSearch();
                            search_burrow_no_consumers_enabled.startSearch();
                            search_burrow_no_consumers_disabled.startSearch();
                            search_burrow_main_table.startSearch();
                            search_burrow_search_env.startSearch();
                            search_burrow_search_label.startSearch();
                            search_burrow_search_cluster.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        //
        // KAFKA CONNECT
        //

        //
        // UPDATE COLLECTION
        //

        // Call this function when the Update collection button is clicked

        $("#btn_manage_content_kafka_connect1").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_update_collection").modal()

            $("#btn_modal_update_collection").click(function() {

                //console.log("Start collection update");

                // Define the query
                var searchQuery = "| savedsearch \"Update Kafka Connect tasks inventory\"";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a normal search that immediately returns the job's SID
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {
                                    //console.log("Done!");

                                    // Once the job is done, update all searches
                                    search_connect_no_connectors_mainsearch.startSearch();
                                    search_connect_no_connectors.startSearch();
                                    search_connect_no_connectors_enabled.startSearch();
                                    search_connect_no_connectors_disabled.startSearch();
                                    search_connect_main_table.startSearch();
                                    search_connect_search_env.startSearch();
                                    search_connect_search_label.startSearch();

                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_done").modal()

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure").modal()
                                }
                            });
                        }
                    }
                );
            });
        });

        //
        // RESET COLLECTION
        //

        // Call this function when the erase collection button is clicked
        $("#btn_manage_content_kafka_connect2").click(function() {
            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            $("#modal_rebuild_collection").modal()

            $("#btn_modal_rebuild_collection").click(function() {

                // Define the query
                var searchQuery = "| outputlookup kafka_connect_tasks_monitoring";

                // Set the search parameters--specify a time range
                var searchParams = {
                    earliest_time: "-4h",
                    latest_time: "now"
                };

                // Run a blocking search and get back a job
                service.search(
                    searchQuery,
                    searchParams,
                    function(err, job) {

                        $("#loadingGray").remove()
                        $("body").append('<div id="loadingGray" style="background: #e9e9e9; display: block; position: fixed; z-index: 100; top: 0; right: 0; bottom: 0; left: 0; height: 100%; opacity: 0.8;"><div style="width: 100%; margin-top: 250px; padding-bottom: 50px; text-align: center;"><p style="font-size: 18pt; font-weight: bolder;">Flushing and updating the KVstore collection...</p></div><div id="spinner"></div></div>')

                        require(["jquery",
                                "/static/app/telegraf-kafka/spin.js"
                            ],
                            function($,
                                Spinner
                            ) {
                                new Spinner({
                                    lines: 12,
                                    position: "relative"
                                }).spin(document.getElementById('spinner'));
                            })

                        // Shall the search fail before we can get properties
                        if (job == null) {
                            let errorStr = "Unknown Error!";
                            if (err && err.data && err.data.messages && err.data.messages[0]['text']) {
                                errorStr = err.data.messages[0]['text'];
                            } else if (err && err.data && err.data.messages) {
                                errorStr = JSON.stringify(err.data.messages);
                            }
                            $("#loadingGray").remove()
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                            $("#modal_update_collection_failure_return").modal()
                        } else {

                            // Poll the status of the search job
                            job.track({
                                period: 200
                            }, {
                                done: function(job) {

                                    // Define the query
                                    var searchQuery = "| savedsearch \"Update Kafka Connect tasks inventory\"";

                                    // Set the search parameters--specify a time range
                                    var searchParams = {
                                        earliest_time: "-4h",
                                        latest_time: "now"
                                    };

                                    // Run a normal search that immediately returns the job's SID
                                    service.search(
                                        searchQuery,
                                        searchParams,
                                        function(err, job) {

                                            // Poll the status of the search job
                                            job.track({
                                                period: 200
                                            }, {
                                                done: function(job) {
                                                    //console.log("Done!");

                                                    // Once the job is done, update all searches
                                                    search_connect_no_connectors_mainsearch.startSearch();
                                                    search_connect_no_connectors.startSearch();
                                                    search_connect_no_connectors_enabled.startSearch();
                                                    search_connect_no_connectors_disabled.startSearch();
                                                    search_connect_main_table.startSearch();
                                                    search_connect_search_env.startSearch();
                                                    search_connect_search_label.startSearch();

                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_done").modal()

                                                },
                                                failed: function(properties) {
                                                    let errorStr = "Unknown Error!";
                                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                                        errorStr = properties._properties.messages[0]['text'];
                                                    } else if (properties && properties._properties && properties._properties.messages) {
                                                        errorStr = JSON.stringify(properties._properties.messages);
                                                    }
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                                    $("#modal_update_collection_failure_return").modal()
                                                },
                                                error: function(err) {
                                                    done(err);
                                                    $("#loadingGray").remove()
                                                    $("#modal_update_collection_failure").modal()
                                                }

                                            });

                                        }
                                    );

                                },
                                failed: function(properties) {
                                    let errorStr = "Unknown Error!";
                                    if (properties && properties._properties && properties._properties.messages && properties._properties.messages[0]['text']) {
                                        errorStr = properties._properties.messages[0]['text'];
                                    } else if (properties && properties._properties && properties._properties.messages) {
                                        errorStr = JSON.stringify(properties._properties.messages);
                                    }
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_return").find('.modal-error-message p').text(errorStr);
                                    $("#modal_update_collection_failure_return").modal()
                                },
                                error: function(err) {
                                    done(err);
                                    $("#loadingGray").remove()
                                    $("#modal_update_collection_failure_flush").modal()
                                }
                            });

                        }

                    }
                );

            });

        });

        //
        // DELETE BUTTON
        //

        // delete entry

        $("#btn_delete_modal_manage_kafka_connector").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_connector").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            // When the Submit button is clicked, get all the form fields by accessing token values
            var modify_key = tokens.get("tk_kafka_connector_keyid");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_connect_tasks_monitoring/" + modify_key;

            if (modify_key && modify_key.length) {

                $("#modal_entry_deletion").modal()
                $("#btn_modal_entry_deletion").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "DELETE",
                        async: true,
                        contentType: "application/json",
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_connect_no_connectors_mainsearch.startSearch();
                            search_connect_no_connectors.startSearch();
                            search_connect_no_connectors_enabled.startSearch();
                            search_connect_no_connectors_disabled.startSearch();
                            search_connect_main_table.startSearch();
                            search_connect_search_env.startSearch();
                            search_connect_search_label.startSearch();

                            // house cleaning
                            myendpoint_URl = undefined;
                            delete(myendpoint_URl);
                            modify_key = undefined;
                            delete(modify_key);
                            return;
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }

                    });

                });

            }

        });

        //
        // MODIFY BUTTON
        //

        // enable monitoring

        $("#btn_enable_modal_manage_kafka_connector").click(function(mode) {

            // Hide main modal
            $("#modal_manage_kafka_connector").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_kafka_connector_keyid");
            var tk_kafka_connector_name = tokens.get("tk_kafka_connector_name");
            var tk_kafka_connector_role = tokens.get("tk_kafka_connector_role");
            var tk_kafka_connector_env = tokens.get("tk_kafka_connector_env");
            var tk_kafka_connector_label = tokens.get("tk_kafka_connector_label");
            var tk_kafka_connector_grace_period = tokens.get("modal_input_kafka_connector_grace_period");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_connect_tasks_monitoring/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "connector": tk_kafka_connector_name,
                "role": tk_kafka_connector_role,
                "env": tk_kafka_connector_env,
                "label": tk_kafka_connector_label,
                "grace_period": tk_kafka_connector_grace_period,
                "monitoring_state": "enabled"
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_connect_no_connectors_mainsearch.startSearch();
                            search_connect_no_connectors.startSearch();
                            search_connect_no_connectors_enabled.startSearch();
                            search_connect_no_connectors_disabled.startSearch();
                            search_connect_main_table.startSearch();
                            search_connect_search_env.startSearch();
                            search_connect_search_label.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // disable monitoring

        $("#btn_disable_modal_manage_kafka_connector").click(function() {

            // Hide main modal
            $("#modal_manage_kafka_connector").modal('hide');

            submitTokens();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");
            var modify_key = tokens.get("tk_kafka_connector_keyid");
            var tk_kafka_connector_name = tokens.get("tk_kafka_connector_name");
            var tk_kafka_connector_role = tokens.get("tk_kafka_connector_role");
            var tk_kafka_connector_env = tokens.get("tk_kafka_connector_env");
            var tk_kafka_connector_label = tokens.get("tk_kafka_connector_label");
            var tk_kafka_connector_grace_period = tokens.get("tk_kafka_connector_grace_period");

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_connect_tasks_monitoring/" + modify_key;

            // Create a dictionary to store the field names and values
            var record = {
                "connector": tk_kafka_connector_name,
                "role": tk_kafka_connector_role,
                "env": tk_kafka_connector_env,
                "label": tk_kafka_connector_label,
                "grace_period": tk_kafka_connector_grace_period,
                "monitoring_state": "disabled"
            };

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#modal_entry_modification").modal()

                $("#btn_modal_entry_modification").click(function() {

                    var that = $(this);
                    that.off('click'); // remove handler

                    $.ajax({
                        url: myendpoint_URl,
                        type: "POST",
                        async: true,
                        contentType: "application/json",
                        data: JSON.stringify(record),
                        success: function(returneddata) {
                            //console.log("Updated!", returneddata)
                            // Run the search again to update the table
                            search_connect_no_connectors_mainsearch.startSearch();
                            search_connect_no_connectors.startSearch();
                            search_connect_no_connectors_enabled.startSearch();
                            search_connect_no_connectors_disabled.startSearch();
                            search_connect_main_table.startSearch();
                            search_connect_search_env.startSearch();
                            search_connect_search_label.startSearch();
                        },
                        error: function(xhr, textStatus, error) {
                            message = "Error Updating!" + xhr + textStatus + error;
                            $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                            $("#modal_update_collection_failure_return").modal()
                        }
                    });

                });

            }

        });

        // modify grace period

        $("#btn_modify_modal_manage_kafka_connector").click(function() {
            submitTokens();

            // Hide main modal
            $("#modal_manage_kafka_connector").modal('hide');

            // Show input modal
            $("#modal_modify_kafka_connector_grace_period").modal();

            // When the Submit button is clicked, get all the form fields by accessing token values
            var tokens = mvc.Components.get("default");

            var modify_key = tokens.get("tk_kafka_connector_keyid");
            var tk_kafka_connector_name = tokens.get("tk_kafka_connector_name");
            var tk_kafka_connector_role = tokens.get("tk_kafka_connector_role");
            var tk_kafka_connector_env = tokens.get("tk_kafka_connector_env");
            var tk_kafka_connector_label = tokens.get("tk_kafka_connector_label");
            var tk_kafka_connector_grace_period = tokens.get("tk_kafka_connector_grace_period");
            var tk_kafka_connector_monitoring_state = tokens.get("tk_kafka_connector_monitoring_state");

            //console.log("Value of tk_kafka_connector_grace_period is: " + tk_kafka_connector_grace_period);

            // Create the endpoint URL
            var myendpoint_URl = "/en-US/splunkd/__raw/servicesNS/nobody/telegraf-kafka/storage/collections/data/kv_telegraf_kafka_connect_tasks_monitoring/" + modify_key;

            if (!modify_key || !modify_key.length) {
                // Show an error message
                $("#modal_entry_update_invalid").modal()
                return;
            } else {

                $("#btn_modal_modify_kafka_connector_grace_period").click(function() {

                    var tk_kafka_connector_grace_period = tokens.get("modal_input_kafka_connector_grace_period");

                    if (!tk_kafka_connector_grace_period || !tk_kafka_connector_grace_period.length || !isNumeric(tk_kafka_connector_grace_period)) {
                        // Show an error message
                        $("#modal_entry_update_invalid").modal()
                        return;
                    } else {

                        // Create a dictionary to store the field names and values
                        var record = {
                            "connector": tk_kafka_connector_name,
                            "role": tk_kafka_connector_role,
                            "env": tk_kafka_connector_env,
                            "label": tk_kafka_connector_label,
                            "grace_period": tk_kafka_connector_grace_period,
                            "monitoring_state": tk_kafka_connector_monitoring_state
                        };

                        var that = $(this);
                        that.off('click'); // remove handler

                        $.ajax({
                            url: myendpoint_URl,
                            type: "POST",
                            async: true,
                            contentType: "application/json",
                            data: JSON.stringify(record),
                            success: function(returneddata) {
                                //console.log("Updated!", returneddata)
                                // Run the search again to update the table
                                search_connect_no_connectors_mainsearch.startSearch();
                                search_connect_no_connectors.startSearch();
                                search_connect_no_connectors_enabled.startSearch();
                                search_connect_no_connectors_disabled.startSearch();
                                search_connect_main_table.startSearch();
                                search_connect_search_env.startSearch();
                                search_connect_search_label.startSearch();
                            },
                            error: function(xhr, textStatus, error) {
                                message = "Error Updating!" + xhr + textStatus + error;
                                $("#modal_update_collection_failure_return").find('.modal-error-message p').text(message);
                                $("#modal_update_collection_failure_return").modal()
                            }
                        });

                    }
                });

            }

        });

        // END OF ALL

    }
);
// ]]>
</script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/telegraf-kafka/table.js" type="text/javascript"></script>
</body>
</html>
